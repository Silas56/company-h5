var pageConfig = {
	
	//index 目录
	//店铺首页
	'indexShop' : {
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '店铺首页'
	},
	// 店铺联系
	'indexShopMerchant':{
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '联系商家'
	},
	// 店铺全部产品
	'indexAllProducts':{
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '全部产品'
	},
	// 店铺最新产品
	'indexShopLatest':{
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '最新产品'
	},
	// 产品目录
	'indexProductCatalog':{
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '产品目录'
	},
	// 推荐产品
	'indexProductRecommend':{
		js : ['shop/static/js/index/index.min.js'], //js文件
		css : ['shop/static/css/index/styles.css'], //css文件
		title : '推荐产品'
	},

	// detial目录
	// 产品详情页
	'productDetail':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '产品详情'
	},
	'productNotFound':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '没有找到你想要访问的产品'
	},
	// 酒店详情
	'detailHotel':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '酒店详情'
	},
	// 其他详情
	'detailOther':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '其他事项'
	},
	// 行程介绍
	'detailTravel':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '行程介绍'
	},
	// 景点详情
	'detailViewport' :{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '景点详情'
	},
	//吃喝玩乐
	'detailLifeStyle' :{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '吃喝玩乐'
	},
	// 预定须知
	'detailBookNotice':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '预定须知'
	},
	// 评论页
	'detailComment':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '评论'
	},
	
	// 自定义事件
	'detailCustomEvent':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '自定义事件'
	},
	// 自定义酒店
	'detailCustomHotel':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '自定义酒店'
	},
	// 自定义吃喝玩乐
	'detailCustomLifeStyle':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '自定义吃喝玩乐'
	},
	// 自定义交通
	'detailCustomTraffic':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '自定义交通'
	},
	// 自定义景点
	'detailCustomViewspot':{
		js : ['shop/static/js/detail/detail.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '自定义景点'
	},
	//交易快照
	'snapshotDetail':{
		js : ['shop/static/js/detail/detailSnapshot.min.js'],
		css : ['shop/static/css/detail/snapshot.css'],
		title : '交易快照'
	},
	//交易快照--行程介绍
	'snapTravel':{
		js : ['shop/static/js/detail/detailSnapshot.min.js'],
		css : ['shop/static/css/detail/detail.css'],
		title : '行程介绍'
	},
	// pay目录
	// 提交订单
	'payfillOrder':{
		js : ['shop/static/js/pay/order.min.js'],
		css : ['shop/static/css/pay/order.css'],
		title : '提交订单'
	},
	// 订单常用联系人
	'payOrderContacts':{
		js : ['shop/static/js/pay/order.min.js'],
		css : ['shop/static/css/pay/order.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	//订单提交成功
	'payOrderResult':{
		js : ['shop/static/js/pay/pay.min.js'],
		css : ['shop/static/css/pay/order.css'],
		title : '订单提交成功'
	},
	//订单提交成功(二次确认)
	'payOrderResult2':{
		js : ['shop/static/js/pay/pay2.min.js'],
		css : ['shop/static/css/pay/order.css'],
		title : '订单提交成功-二次确认'
	},
	// 支付完成
	'paySuccess':{
		js : ['shop/static/js/pay/order.min.js'],
		css : ['shop/static/css/pay/order.css'],
		title : '支付完成'
	},

	// home目录
	//全部店铺列表
	'allShop': {
		js : ['shop/static/js/home/allShop.min.js'],
		css : ['shop/static/css/home/allShop.css'],
		title : '店铺列表'
	},
	// 个人首页
	'user_pageCurrent':{
		js : ['shop/static/js/home/memeberUser.min.js','shop/static/js/home/userCenter.min.js'],
		css : ['shop/static/css/home/memberUser.css','shop/static/css/home/memberMyCollection.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	// 常用联系人
	'homeInformation':{
		js : ['shop/static/js/home/information.min.js'],
		css : ['shop/static/css/home/information.css'],
		title : '常用联系人'
	},
	'homeAddInformation':{
		js : ['shop/static/js/home/information.min.js'],
		css : ['shop/static/css/home/information.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'homeEditInformation':{
		js : ['shop/static/js/home/information.min.js'],
		css : ['shop/static/css/home/information.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'accountsSafe':{
		js : ['shop/static/js/home/accountSafe.min.js'],
		css : ['shop/static/css/home/style.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'accountsetting':{
		js : ['shop/static/js/home/accountSetting.min.js'],
		css : ['shop/static/css/home/style.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'changename':{
		js : ['shop/static/js/home/information.min.js'],
		css : ['shop/static/css/home/style.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'changepassword1':{
		js : ['shop/static/js/home/changepassword.min.js'],
		css : ['shop/static/css/home/style.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'changepassword2':{
		js : ['shop/static/js/home/changepassword.min.js'],
		css : ['shop/static/css/home/style.css'],
		title : '修改登录密码'
	},
	'memberArbitration':{
		js : ['shop/static/js/home/_memberArbitration.min.js','shop/static/js/home/memeberUser.min.js'],
		css : ['shop/static/css/home/memberUser.css'],
		title : '申请仲裁'
	},
	'memberEvaluate':{
		js : ['shop/static/js/home/_memberEvaluate.min.js','shop/static/js/home/memeberUser.min.js'],
		css : ['shop/static/css/home/memberUser.css'],
		title : '评价'
	},
	'page_member_order':{
		js:['shop/static/js/home/_memberOrder.min.js'],
		css:['shop/static/css/home/memberUser.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	'suggestion_pageCurrent':{
		js:['shop/static/js/home/suggestion.min.js'],
		css:['shop/static/css/home/style.css'],
		title : '意见反馈'
	},
	'refund_pageCurrent':{
		js:['shop/static/js/home/_memberRefund.min.js'],
		css:['shop/static/css/home/memberUser.css'],
		title : '申请退款'
	},
	'orderDetail_pageCurrent':{
		js:['shop/static/js/home/memeberUser.min.js', 'shop/static/js/home/_memberOrderDetails.min.js'],
		css:['shop/static/css/home/memberUser.css'],
		title : '订单详情'
	},
	'mynews_pageCurrent':{
		js:['shop/static/js/home/_memberMynews.min.js'],
		css:['shop/static/css/home/memberUser.css'],
		title : '我的消息'
	},
	'page_myCollection':{
		js:['shop/static/js/home/memeberUser.min.js', 'shop/static/js/home/_memberMyCollectionPro.min.js'],
		css:['shop/static/css/home/memberUser.css', 'shop/static/css/home/memberMyCollection.css'],
		title : '特色旅游_高端旅游_主题旅游_酷鸟'
	},
	
	//搜索
	'search_page':{
		js:['shop/static/js/search/search.min.js'],
		css:['shop/static/css/search/search.css'],
		title : '搜索'
	},
	'searchShop_page':{
		js:['shop/static/js/search/searchShop.min.js'],
		css:['shop/static/css/search/searchShop.css', 'shop/static/css/index/styles.css'],
		title : '店铺搜索'
	},
	'searchProduct_page':{
		js:['shop/static/js/search/searchProduct.min.js'],
		css:['shop/static/css/index/styles.css', 'shop/static/css/common/style.css', 'shop/static/css/search/searchProduct.css'],
		title : '产品搜索'
	},

	//404
	'about_404':{
		js:[],
		css:['shop/static/css/about/404.css'],
		title : '404'
	}
};

var serverBase = '/';

var PageLoad = {
	pageId : '',
	cacheFile : {
		js : [],
		css : []
	},
	init : function(pageId){
		this.pageId = pageId;

		this.loadCss();
		this.loadJs();
	},
	loadJs : function(){
		if(typeof pageConfig[this.pageId]!== 'undefied'){
			var jsFile = pageConfig[this.pageId].js ;

				for(var i = 0 ; i < jsFile.length ; i++){

					if(!this.isLoad(jsFile[i],'js')){
						var s 	= document.createElement('script'),
							src = serverBase + jsFile[i];

						s.setAttribute('type','text/javascript');
						s.setAttribute('src',src);

						document.getElementsByTagName('body')[0].appendChild(s);

						this.cacheFile.js.push(jsFile[i]);
					}
				}
		}else{
			console.log('这个pageId不存在配置中!')
		}
	},
	loadCss : function(){
		if(typeof pageConfig[this.pageId] !== 'undefied'){
			var cssFile = pageConfig[this.pageId].css;

				for(var i = 0 ; i < cssFile.length ; i++){

					if(!this.isLoad(cssFile[i],'css')){
						var s 	= document.createElement('link'),
							src = serverBase + cssFile[i];

						s.setAttribute('rel','stylesheet');
						s.setAttribute('href',src);

						document.getElementsByTagName('head')[0].appendChild(s);

						this.cacheFile.css.push(cssFile[i]);
					}
				}
		}else{
			console.log('这个pageId不存在配置中!')
		}
	},
	//检查文件是否已经加载过
	isLoad : function(name,type){
		var arr = [];

			if(type === 'css'){
				arr = this.cacheFile.css;
			}else if(type == 'js'){
				arr = this.cacheFile.js;
			}

			for(var i = 0 ; i< arr.length ; i++){
				if(arr[i] === name){
					return true;
				}
			}

			return false;
	},
	firstHander : function(){

		var pageId = $('.page-current').attr('id');

			// console.log(pageId);

			if(!pageConfig.hasOwnProperty(pageId)){
				return false;
			}

		var jsFile = pageConfig[pageId].js ;

			for(var i = 0 ; i < jsFile.length ; i++){
				this.cacheFile.js.push(jsFile[i]);
			}
		var cssFile = pageConfig[pageId].css ;	
			for(var i = 0 ; i < jsFile.length ; i++){
				this.cacheFile.css.push(cssFile[i]);
			}
	},
	recordHref : function(){
		// console.log(location.href);
		var url = encodeURIComponent(location.href);
		$.ajax({
			url : '/m/api/global/visited.json?url='+url+'',
			type : 'get',
			dataType : 'json',
			success : function(){

			}
		});
	},
	changeTitile : function(pageId){
			if(!pageConfig.hasOwnProperty(pageId)){
				return false;
			}
			// console.log(pageId);
			document.title = pageConfig[pageId].title;
	}
};

PageLoad.firstHander();
// PageLoad.recordHref();

$(document).on('pageAnimationStart','.page',function(e,pageId,$page){
	$.closeModal(".picker-modal.modal-in");
	// console.log(pageId);
	PageLoad.init(pageId);
	// PageLoad.recordHref();
});

$(document).on('pageAnimationEnd','.page',function(e,pageId,$page){
	// console.log(pageId);
	PageLoad.changeTitile(pageId);
	// PageLoad.recordHref();
});


$(document).on('pageInit',function(e,pageId,$page){
	PageLoad.recordHref();
});



