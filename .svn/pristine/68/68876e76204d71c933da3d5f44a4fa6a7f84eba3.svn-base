!function e(t,o,n){function i(a,r){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(s)return s(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var d=o[a]={exports:{}};t[a][0].call(d.exports,function(e){var o=t[a][1][e];return i(o?o:e)},d,d.exports,e,t,o,n)}return o[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,o){!function(e){function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function i(){this.raw=[],this.length=0}function s(){return"___"+T++}function a(e,t){var o=new Function;o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}function r(e){return _[e]}function c(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function p(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function d(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,o){return t[o-0+1]})}function l(e){return e=e.replace(/^\s*\*/,""),d('gv({0},["{1}"])',c(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function h(e,t,o,n,i,s){for(var a=o.length,r=e.split(t),c=0,p=[],d=0,l=r.length;l>d;d++){var h=r[d];if(d){var f=1;for(c++;;){var u=h.indexOf(o);if(0>u){p.push(c>1&&f?t:"",h);break}if(c=n?c-1:0,p.push(c>0&&f?t:"",h.slice(0,u),c>0?o:""),h=h.slice(u+a),f=0,0===c)break}0===c&&(i(p.join("")),s(h),p=[])}else h&&s(h)}c>0&&p.length>0&&(s(t),s(p.join("")))}function f(e,t,o){var n,i=[],s=t.options,a="",r="",p="",d="";return o&&(a="ts(",r=")",p=P,d=q,n=s.defaultFilter),h(e,s.variableOpen,s.variableClose,1,function(e){o&&e.indexOf("|")<0&&n&&(e+="|"+n);var s=e.indexOf("|"),c=(s>0?e.slice(0,s):e).replace(/^\s+/,"").replace(/\s+$/,""),h=s>0?e.slice(s+1):"",u=0===c.indexOf("*"),g=[u?"":a,l(c),u?"":r];if(h){h=f(h,t);for(var m=h.split("|"),v=0,y=m.length;y>v;v++){var $=m[v];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test($)&&(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&g.push(",",RegExp.$3),g.push(")"))}}i.push(p,g.join(""),d)},function(e){i.push(p,o?c(e):e,d)}),i.join("")}function u(e,t){this.value=e,this.engine=t}function g(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function m(e,t){var o=e.stack,n=t?o.find(function(e){return e instanceof t}):o.bottom();if(n){for(var i;(i=o.top())!==n;){if(!i.autoClose)throw new Error(i.type+" must be closed manually: "+i.value);i.autoClose(e)}n.close(e)}return n}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,g.call(this,e,t),this.blocks={}}function y(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,g.call(this,e,t),this.cloneProps=["name"]}function $(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,g.call(this,e,t),this.cloneProps=["name","state","blocks","target"],this.blocks={}}function C(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,g.call(this,e,t),this.cloneProps=["name","expr"]}function I(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,e,t),this.cloneProps=["name","args"]}function x(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,e,t),this.cloneProps=["name","args"]}function b(e,t){var o=new RegExp(d("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",p(t.options.variableOpen),p(t.options.variableClose)),"i");if(!o.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,g.call(this,e,t),this.cloneProps=["list","item","index"]}function w(e,t){g.call(this,e,t)}function R(e,t){w.call(this,e,t)}function S(e,t){g.call(this,e,t)}function j(e,t){t.target=e;var o=t.engine,n=e.name;if(o.targets[n])switch(o.options.namingConflict){case"override":o.targets[n]=e,t.targets.push(n);case"ignore":break;default:throw new Error("[ETPL_TARGET_EXISTS]"+n)}else o.targets[n]=e,t.targets.push(n)}function N(e,t){U[e]=t,t.prototype.type=e}function k(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]*)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=n({},B)}function E(e,t){function o(){var e;if(d.length>0&&(e=d.join(""))){var o=new u(e,t);o.beforeAdd(p),c.top().addChild(o),d=[],t.options.strip&&p.current instanceof g&&(o.value=e.replace(/^[\x20\t\r]*\n/,"")),p.current=o}}var n,s=t.options.commandOpen,a=t.options.commandClose,r=t.options.commandSyntax,c=new i,p={engine:t,targets:[],stack:c,target:null},d=[];return h(e,s,a,0,function(e){var i,c=r.exec(e);if(c&&(i=c[2]||"target")&&(n=U[i.toLowerCase()])&&"function"==typeof n){o();var l=p.current;t.options.strip&&l instanceof u&&(l.value=l.value.replace(/\r?\n[\x20\t]*$/,"\n")),c[1]?l=m(p,n):(l=new n(c[3],t),"function"==typeof l.beforeOpen&&l.beforeOpen(p),l.open(p)),p.current=l}else/^\s*\/\//.test(e)||d.push(s,e,a);n=null},function(e){d.push(e)}),o(),m(p),p.targets}i.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var o=this.raw[t];if(e(o))return o}}};var T=178245,_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},B={html:function(e){return e.replace(/[&<>"']/g,r)},url:encodeURIComponent,raw:function(e){return e}},L='var r="";',P="r+=",q=";",A="return r;";"undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(L="var r=[],ri=0;",P="r[ri++]=",A='return r.join("");'),u.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;return!e||t.strip&&/^\s*$/.test(e)?"":f(e,this.engine,1)},clone:function(){return this}},g.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){e.stack.top()===this&&e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,o=0;o<t.length;o++)e.push(t[o].getRendererBody());return e.join("")},clone:function(){for(var e=this.constructor,t=new e(this.value,this.engine),o=0,n=this.children.length;n>o;o++)t.addChild(this.children[o].clone());for(var o=0,n=this.cloneProps.length;n>o;o++){var i=this.cloneProps[o];t[i]=this[i]}return t}};var F='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';a(v,g),a(y,g),a($,g),a(C,g),a(I,g),a(x,g),a(b,g),a(w,g),a(R,w),a(S,w);var M={READING:1,READED:2,APPLIED:3,READY:4};$.prototype.applyMaster=v.prototype.applyMaster=function(e){function t(e){var n=e.children;if(n instanceof Array)for(var i=0,s=n.length;s>i;i++){var a=n[i];a instanceof y&&o[a.name]&&(a=n[i]=o[a.name]),t(a)}}if(this.state>=M.APPLIED)return 1;var o=this.blocks,n=this.engine.targets[e];if(n){if(n.applyMaster(n.master))return this.children=n.clone().children,t(this),this.state=M.APPLIED,1}else if("error"===this.engine.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+e+", when extended by "+(this.target?this.target.name:this.name))},v.prototype.isReady=function(){function e(i){for(var s=0,a=i.children.length;a>s;s++){var r=i.children[s];if(r instanceof $){var c=t.targets[r.name];if(!c&&"error"===t.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+r.name+", when imported by "+o);n=n&&c&&c.isReady(t)}else r instanceof g&&e(r)}}if(this.state>=M.READY)return 1;var t=this.engine,o=this.name,n=1;return this.applyMaster(this.master)?(e(this),n&&(this.state=M.READY),n):void 0},v.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[F,L,this.getRendererBody(),A].join("\n")),t=this.engine;return this.renderer=function(o){return e(o,t)},this.renderer}return null},v.prototype.open=function(e){m(e),g.prototype.open.call(this,e),this.state=M.READING,j(this,e)},C.prototype.open=x.prototype.open=function(e){e.stack.top().addChild(this)},y.prototype.open=function(e){g.prototype.open.call(this,e),e.stack.find(function(e){return e.blocks}).blocks[this.name]=this},R.prototype.open=function(e){var t=new S;t.open(e);var o=m(e,w);o.addChild(this),e.stack.push(this)},S.prototype.open=function(e){var t=m(e,w);t.addChild(this),e.stack.push(this)},$.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,g.prototype.open.call(this,e),this.state=M.READING},x.prototype.close=C.prototype.close=function(){},$.prototype.close=function(e){g.prototype.close.call(this,e),this.state=M.READED},v.prototype.close=function(e){g.prototype.close.call(this,e),this.state=this.master?M.READED:M.APPLIED,e.target=null},$.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var o in this.blocks)this.target.blocks[o]=this.blocks[o];this.blocks={},this.close(e)},x.prototype.beforeOpen=$.prototype.beforeOpen=C.prototype.beforeOpen=b.prototype.beforeOpen=I.prototype.beforeOpen=y.prototype.beforeOpen=w.prototype.beforeOpen=u.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new v(s(),e.engine);t.open(e)}},$.prototype.getRendererBody=function(){return this.applyMaster(this.name),g.prototype.getRendererBody.call(this)},x.prototype.getRendererBody=function(){return d("{0}engine.render({2},{{3}}){1}",P,q,c(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,o){return(t||"")+c(o)+":"}))},C.prototype.getRendererBody=function(){return this.expr?d("v[{0}]={1};",c(this.name),f(this.expr,this.engine)):""},w.prototype.getRendererBody=function(){return d("if({0}){{1}}",f(this.value,this.engine),g.prototype.getRendererBody.call(this))},S.prototype.getRendererBody=function(){return d("}else{{0}",g.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){return d('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',s(),f(this.list,this.engine),c(this.index||s()),c(this.item),s(),s(),g.prototype.getRendererBody.call(this))},I.prototype.getRendererBody=function(){var e=this.args;return d("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",L,A,P,q,g.prototype.getRendererBody.call(this),c(this.name),e?","+f(e,this.engine):"")};var U={};N("target",v),N("block",y),N("import",$),N("use",x),N("var",C),N("for",b),N("if",w),N("elif",R),N("else",S),N("filter",I),k.prototype.config=function(e){n(this.options,e)},k.prototype.compile=k.prototype.parse=function(e){if(e){var t=E(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},k.prototype.getRenderer=function(e){var t=this.targets[e];return t?t.getRenderer():void 0},k.prototype.render=function(e,t){var o=this.getRenderer(e);return o?o(t):""},k.prototype.addFilter=function(e,t){"function"==typeof t&&(this.filters[e]=t)};var O=new k;O.Engine=k,O.version="3.1.0","object"==typeof o&&"object"==typeof t?o=t.exports=O:"function"==typeof define&&define.amd?define(O):e.etpl=O}(this)},{}],2:[function(e,t,o){var n=function(){};n.prototype.getUrlParam=function(){for(var e=location.search.slice(1),t={},o=e.split("&"),n=0;n<o.length;n++){var i=o[n].split("=");t[i[0]]||(t[i[0]]=i[1])}return t},n.prototype.localStorage={get:function(e){var t="";if("undefined"==typeof localStorage[e])return!1;try{return t=JSON.parse(localStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(o){return localStorage[e]}},set:function(e,t){return"undefined"!=typeof t&&(localStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof localStorage[e]?console.log("this item is not exit!"):delete localStorage[e]}},n.prototype.sessionStorage={get:function(e){var t="";if("undefined"==typeof sessionStorage[e])return"undefined";try{return t=JSON.parse(sessionStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(o){return sessionStorage[e]}},set:function(e,t){return"undefined"!=typeof t&&(sessionStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof sessionStorage[e]?console.log("this item is not exit!"):delete sessionStorage[e]}},n.prototype.config={serverBase:"/m/",knIndex:"/m/nav/kn/index",loginHref:"/m/nav/login",logoutHref:"/m/nav/logout"},"object"==typeof t&&"object"==typeof t.exports?t.exports=new n:window.GlobalKuNiao=n},{}],3:[function(e,t,o){var n=e("../common/global.js"),i=function(){};i.prototype.initWeixin=function(e){$.ajax({url:n.config.serverBase+"jsApi/ticket",type:"GET",data:{url:e},success:function(e){e&&"100"===e.code&&wx.config({debug:!1,appId:e.jsApiTicketBean.appId,timestamp:e.jsApiTicketBean.timestamp,nonceStr:e.jsApiTicketBean.nonceStr,signature:e.jsApiTicketBean.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage"]})}})},i.prototype.onMenuShareAppMessage=function(e,t,o,n){wx.onMenuShareAppMessage({title:e,desc:n,link:t,imgUrl:o,type:"",dataUrl:"",success:function(){},cancel:function(){}})},i.prototype.onMenuShareTimeline=function(e,t,o){wx.onMenuShareTimeline({title:e,link:t,imgUrl:o,success:function(){},cancel:function(){}})},i.prototype.wechat_sendAppMsg=function(e,t,o,n){WeixinJSBridge.invoke("sendAppMessage",{img_url:e,img_width:"200",img_height:"200",link:encodeURIComponent(t),desc:encodeURIComponent(o),title:encodeURIComponent(n)},function(e){"send_app_msg:confirm"==e.err_msg?$.toast("分享成功"):$.toast("分享失败")})},i.prototype.wechat_timeLine=function(e,t,o,n){WeixinJSBridge.invoke("shareTimeline",{img_url:e,img_width:"200",img_height:"200",link:encodeURIComponent(t),desc:encodeURIComponent(o),title:encodeURIComponent(n)},function(e){"share_timeline:ok"==e.err_msg?$.toast("分享成功"):$.toast("分享失败")})},i.prototype.qq_friends=function(e,t,o,n,i,s){"undefind"==typeof n&&""!==n||(n="1105220679");var a="http://openmobile.qq.com/api/check?page=shareindex.html&style=9&status_os=0&sdkp=0&action=shareToQQ";return a+="&site="+encodeURIComponent(e),a+="&title="+encodeURIComponent(t),a+="&imageUrl="+o,a+="&appid="+n,a+="&targetUrl="+encodeURIComponent(i),a+="&page_url="+encodeURIComponent(s)},i.prototype.qzone=function(e,t,o,n,i,s){var a="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(e);return a+="&title="+t,a+="&desc="+o,a+="&summary="+n,a+="&site="+i,a+="&pics="+encodeURIComponent(s)},i.prototype.weibo=function(e,t,o,n,i){var s="http://v.t.sina.com.cn/share/share.php?";return s+="appkey="+e,s+="&ralateUid="+t,s+="&title="+encodeURIComponent(o),s+="&url="+encodeURIComponent(n),s+="&pic="+i},"object"==typeof t&&"object"==typeof t.exports?t.exports=new i:window.KN_Share=i},{"../common/global.js":2}],4:[function(e,t,o){function n(e,t,o,n){if($.device.iphone){document.getElementsByTagName("body")[0];document.title=e;var i=document.createElement("iframe");i.style.display="none",i.setAttribute("src","http://named.cn/page/take/img/icon_phone.png");var s=function(){setTimeout(function(){i.removeEventListener("load",s),document.body.removeChild(i)},0)};i.addEventListener("load",s),document.body.appendChild(i)}else document.title=e;$('meta[name="Keywords"]').attr("content",t),$('meta[name="Description"]').attr("content",o),n&&($('meta[name="ogTitle"]').attr("content",e),$('meta[name="ogDesc"]').attr("content",o),$('meta[name="ogFlag"]').attr("content",t))}var i=e("../common/global.js"),s=e("../common/etpl.js"),a=e("./tpl/shopIndex.html"),r=e("./tpl/productItem.html"),c=e("./tpl/contactMerchant.html"),p=e("../common/share.js"),d={config:{shopCode:"",apiBase:"",request:{shopInfo:!1,advImg:!1,recommendProduct:!1,productList:!1},data:{},isNeedFav:0},init:function(){var e=i.getUrlParam();return this.config.isNeedFav=e.needFav,"undefined"==typeof e.shopCode?($.alert("该店铺不存在",function(){location.href=i.config.knIndex}),!1):(this.config.shopCode=e.shopCode,this.config.apiBase=i.config.serverBase,this.config.request={shopInfo:!1,advImg:!1,recommendProduct:!1,productList:!1},this.tplFilter(),this.getData(),$(".fixed-tab-shop").find(".merchant-link").attr("href","./contactMerchant.html?shopCode="+e.shopCode),this.proCategory(),void i.localStorage.set("shopCode",e.shopCode))},getData:function(){var e=this.config.apiBase+"api/shop/info.json",t=this.config.apiBase+"api/shop/advImg.json",o=this.config.apiBase+"api/shop/recommendProduct.json",n=this.config.apiBase+"api/shop/productList.json",i={};i={shopCode:this.config.shopCode},this.sendRequest(e,i,"shopInfo","get"),this.sendRequest(t,i,"advImg","get"),this.sendRequest(o,i,"recommendProduct","get"),this.sendRequest(n,i,"productList","get")},sendRequest:function(e,t,o,s){var a=this;"post"===s&&(t=JSON.stringify(t)),$.ajax({url:e,type:s,data:t,dataType:"json",contentType:"application/json",success:function(e){if(a.config.request[o]=!0,"100"===e.code){if("shopInfo"===o){console.log(e),a.config.data[o]=e.shopInfo,1===e.shopInfo.shopStatus&&$(".fixed-tab-shop").show();var t=e.shopInfo.shopName,s=e.shopInfo.shopName+",特色旅游,高端旅游,主题旅游,旅游线路,酷鸟",r="酷鸟旅游网，一个提供特色旅游(旅行)、高端旅游(旅行)、主题旅游(旅行)、旅游线路、旅行线路的旅游网站，特色旅游找酷鸟。酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。";n(t,s,r,1);var c="";"undefined"!=typeof e.shopInfo.shopLogoImg&&(c=e.shopInfo.shopLogoImg);var d=" ";"undefined"!=typeof e.shopInfo.shopIntroduction&&(d=e.shopInfo.shopIntroduction);var l=window.location.href;p.initWeixin(l),wx.ready(function(){p.onMenuShareTimeline(t,l,c),p.onMenuShareAppMessage(t,l,c,d)})}else"advImg"===o?a.config.data[o]=e.list:"recommendProduct"===o?e.page.list.length>0&&(a.config.data[o]=e.page.list):"productList"===o&&e.page.list.length>0&&(a.config.data[o]=e.page.list);a.render()}else"300"===e.code&&"shopInfo"===o&&$.alert(e.msg,function(){location.href=i.config.knIndex})},error:function(){a.config.request[o]=!0}})},isCompleteRequest:function(){for(var e in this.config.request)if(this.config.request[e]===!1)return!1;return!0},render:function(){if(!this.isCompleteRequest())return!1;var e=this.config.data,t=s.compile(a),o=t(e);$("#indexShop .content").html(o),this.pageInit(),this.isShopCollect(),$(".item").on("click",function(){var e=$(this).attr("data-pcode"),t=$(this).attr("data-scode");$.router.load("../detail/detail.html?productCode="+e+"&shopCode="+t)})},proCategory:function(){var e=this,t={shopCode:this.config.shopCode};$.ajax({url:this.config.apiBase+"api/shop/productCate.json",type:"get",data:t,contentType:"application/json",dataType:"json",success:function(t){if("100"===t.code){if(!t.hasOwnProperty("list"))return!1;if(0===t.list.length)return!1;for(var o="",n=0;n<t.list.length;n++)o+='<a href="productCatalog.html?shopCode=',o+=e.config.shopCode+"&catalogCode="+t.list[n].catalogCode,o+="&catalogName="+t.list[n].catalogName,o+='">'+t.list[n].catalogName+"</a>";$(".catogery-list").html(o),$(".fixed-tab-shop").on("click",".category-btn",function(){$(this).hasClass("catogery-list-active")?$(this).removeClass("catogery-list-active"):$(this).addClass("catogery-list-active")})}}})},pageInit:function(){$(".swiper-container").swiper({autoplay:3e3,autoplayDisableOnInteraction:!1,speed:600}),$(".user").click(function(){window.location.href="../home/memberUser.html"}),$(".knIndex").click(function(){window.location.href=i.config.knIndex}),$(".userCenter").click(function(){window.location.href="../home/memberUser.html"})},isShopCollect:function(){var e=$(".collection"),t=i.config.serverBase+"api/user/shopIsFaved.json",o={shopCode:this.config.shopCode};$.ajax({url:t,type:"get",dataType:"json",data:o,success:function(t){"101"===t.code&&"1"===d.config.isNeedFav&&d.updateFav(d.config.shopCode,1),"100"===t.code&&e.addClass("has-collection").html("已收藏")}}),e.off("click").on("click",function(){d.updateFav(d.config.shopCode,1)})},updateFav:function(e,t){var o=$(".collection"),n=i.config.serverBase+"api/user/updateFav.json",s={shopCode:e,favType:2,updateType:t},a="收藏成功";o.hasClass("has-collection")&&(s.updateType=2,a="取消收藏成功"),$.ajax({url:n,type:"post",dataType:"json",data:JSON.stringify(s),contentType:"application/json",success:function(e){if("100"===e.code)$.toast(a),1===s.updateType?o.addClass("has-collection").html("已收藏"):o.removeClass("has-collection").html("收藏");else if("403"===e.code){var t=location.href+"&needFav=1";t=encodeURIComponent(t),$.ajax({url:"/m/api/global/visited.json?url="+t,type:"get",dataType:"json",success:function(){window.location.href=i.config.loginHref}})}else $.toast(e.msg)}})},tplFilter:function(){s.addFilter("scoreFormat",function(e){return e/5*100})}},l={config:{shopCode:"",apiBase:"",param:{},data:{},pageNum:{shopRecommend:1,shopLatest:1},loading:!1,firstLoad:!0,sort:""},init:function(e){var t=i.getUrlParam();return"undefined"==typeof t.shopCode?($.router.back(),!1):(this.config.shopCode=t.shopCode,this.config.apiBase=i.config.serverBase,"shopRecommend"===e?(this.config.url=this.config.apiBase+"/api/shop/recommendProduct.json",this.config.param.shopCode=this.config.shopCode,this.config.param.pageSize=10,this.config.param.pageNum=this.config.pageNum.shopRecommend,this.config.sort="shopRecommend",this.getShopInfo(t.shopCode,"推荐产品")):"shopLatest"===e&&(this.config.url=this.config.apiBase+"/api/shop/productList.json",this.config.param.shopCode=this.config.shopCode,this.config.param.pageSize=10,this.config.param.orderField="last_updated_time",this.config.param.pageNum=this.config.pageNum.shopLatest,this.config.sort="shopLatest",this.getShopInfo(t.shopCode,"最新上架")),void(0===$("#content").find(".item").size()?this.getData():this.scroll()))},getData:function(){var e=this.config.url;this.sendRequest(e,this.config.param,"latest")},sendRequest:function(e,t,o){var n=this;$.ajax({url:e,type:"get",data:t,contentType:"application/json",dataType:"json",success:function(e){"100"===e.code&&(n.config.total=e.page.pageCount,n.config.data[o]=e.page.list,n.render(),n.config.loading=!1,"latest"===o&&(n.config.firstLoad&&(n.config.firstLoad=!1,n.scroll()),e.page.list.length<10&&($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove())))},error:function(){}})},scroll:function(){var e=this;$(".content").on("infinite",function(){if(e.config.loading)return!1;e.config.loading=!0;var t=e.config.total;return e.config.param.pageNum>t?($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove(),!1):(e.config.pageNum[e.config.sort]++,e.config.param.pageNum=e.config.pageNum[e.config.sort],void e.sendRequest(e.config.url,e.config.param,"latest"))})},render:function(){var e=this.config.data.latest,t=s.compile(r),o=t({data:e});$(".content .con").append(o),$(".loading-spiner").hide(),$(".item").on("click",function(){var e=$(this).attr("data-pcode"),t=$(this).attr("data-scode");$.router.load("../detail/detail.html?productCode="+e+"&shopCode="+t)})},getShopInfo:function(e,t){$.ajax({url:i.config.serverBase+"/api/shop/info.json",type:"GET",data:{shopCode:e},success:function(e){if(e&&"100"===e.code){var o=t+"_"+e.shopInfo.shopName,i=t+","+e.shopInfo.shopName+", 特色旅游,高端旅游,酷鸟。",s=t+"_"+e.shopInfo.shopName+"，酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。";""===t&&(o=e.shopInfo.shopName+"_酷鸟",i=e.shopInfo.shopName+", 特色旅游,高端旅游,酷鸟。",s=e.shopInfo.shopName+"，酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。"),n(o,i,s);var a="";"undefined"!=typeof e.shopInfo.shopLogoImg&&(a=e.shopInfo.shopLogoImg),o=e.shopInfo.shopName+"_"+t;var r=window.location.href;p.initWeixin(r),wx.ready(function(){p.onMenuShareTimeline(o,r,a),p.onMenuShareAppMessage(o,r,a," ")})}}})}},h={config:{shopCode:"",apiBase:"",data:{},isNeedFav:0},init:function(){var e=i.getUrlParam();return this.config.isNeedFav=e.needFav,"undefined"==typeof e.shopCode?($.router.back(),!1):(this.config.shopCode=e.shopCode,this.config.apiBase=i.config.serverBase,this.getData(),void this.isCollected())},isCollected:function(){var e={shopCode:h.config.shopCode,favType:2,updateType:1};$.ajax({url:h.config.apiBase+"/api/user/shopIsFaved.json",type:"GET",data:e,success:function(e){if("101"===e.code&&"1"===h.config.isNeedFav)h.updateFav(h.config.shopCode,1);else if("101"===e.code){var t=$(".collected-bottom");t.text("收藏"),t.removeClass("collected-bottom").addClass("collect-bottom"),h.initCollect()}else if("100"===e.code){var o=$(".collect-bottom");o.text("已收藏"),o.removeClass("collect-bottom").addClass("collected-bottom"),h.initCollected()}else"205"===e.code||("403"===e.code?h.initCollect():$.toast("error:"+e.msg))}})},updateFav:function(e,t){var o={shopCode:e,updateType:t,favType:2};$.ajax({url:h.config.apiBase+"api/user/updateFav.json",type:"POST",data:JSON.stringify(o),contentType:"application/json",success:function(e){if(e&&"100"===e.code)if(1===t){var o=$(".collect-bottom");o.text("已收藏"),o.removeClass("collect-bottom").addClass("collected-bottom"),h.initCollected(),$.toast("收藏成功")}else{$.toast("取消成功");var n=$(".collected-bottom");n.text("收藏"),n.removeClass("collected-bottom").addClass("collect-bottom"),h.initCollect()}else if("205"===e.code);else if(e&&"403"===e.code){var s=location.href+"&needFav=1";s=encodeURIComponent(s),$.ajax({url:"/m/api/global/visited.json?url="+s,type:"get",dataType:"json",success:function(){window.location.href=i.config.loginHref}})}else $.toast("error:"+e.msg)}})},initCollect:function(){$(".collect-bottom").unbind("click").click(function(){h.updateFav(h.config.shopCode,1)})},initCollected:function(){$(".collected-bottom").unbind("click").click(function(){h.updateFav(h.config.shopCode,2)})},getData:function(){var e=this.config.apiBase+"api/shop/info.json",t={};t={shopCode:this.config.shopCode},this.sendRequest(e,t,"shopInfo")},sendRequest:function(e,t,o){var i=this;$.ajax({url:e,type:"get",data:t,dataType:"json",contentType:"application/json",success:function(e){if(console.log(e),"100"===e.code){i.config.data[o]=e[o],i.render();var t="联系商家_"+e.shopInfo.shopName,s=e.shopInfo.shopName+", 特色旅游,高端旅游,酷鸟。",a=e.shopInfo.shopName+"，酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。";n(t,s,a);var r="";"undefined"!=typeof e.shopInfo.shopLogoImg&&(r=e.shopInfo.shopLogoImg),t=e.shopInfo.shopName+"_联系商家";var c=window.location.href;p.initWeixin(c),wx.ready(function(){p.onMenuShareTimeline(t,c,r),p.onMenuShareAppMessage(t,c,r," ")})}},error:function(){}})},render:function(){for(var e=this.config.data.shopInfo,t=parseInt(e.shopScore),o=1*e.shopScore-t,n=[],i=0;i<5;i++)i<t?n[i]="14px":i==t?n[i]=14*o+"px":n[i]="0px";e.scoreList=n;var a=s.compile(c),r=a(e);$(".content").html(r)}},f={config:{tabs:0,cache:[],data:{},loading:!1,firstLoad:!0,pageNum:{all:1,sale:1,price:1},pageSize:{all:0,sale:0,price:0},total:{all:0,sale:0,price:0},sort:"all"},init:function(e){var t=i.getUrlParam();if("undefined"==typeof t.shopCode)return $.router.back(),!1;"undefined"!=typeof t.catalogName&&$("h1").html(decodeURI(t.catalogName)),this.config.url=i.config.serverBase+"api/shop/productList.json","allProducts"===e?(this.config.param={pageNum:this.config.pageNum[this.config.sort],shopCode:t.shopCode,pageSize:10,orderField:"volume",orderValue:"desc"},this.getShopInfo(t.shopCode,"全部产品")):(this.config.param={pageNum:this.config.pageNum[this.config.sort],shopCode:t.shopCode,catalogCode:t.catalogCode,pageSize:10,orderField:"last_updated_time",orderValue:"desc"},this.getShopInfo(t.shopCode,"产品目录"));var o=$(".tabs").find(".con").eq(0);0===o.find(".item").size()&&this.getData(),this.scroll();var n=this;$(".buttons-tab").on("click","a",function(){var e=parseInt($(this).data("sort"),10),t=!1;2===n.config.tabs&&2===e&&(t=!0),n.config.loading=!0,n.config.tabs=e,0===e?(n.config.param.orderField="volume",n.config.sort="all",n.config.param.orderValue="desc"):1===e?(n.config.param.orderField="volume",n.config.sort="sale",n.config.param.orderValue="desc"):2===e&&(n.config.param.orderField="price",n.config.sort="price",n.config.param.orderValue="asc"),t&&(n.config.pageSize.price=0,$(this).hasClass("desc")?(n.config.param.orderValue="asc",$(this).removeClass("desc")):(n.config.param.orderValue="desc",$(this).addClass("desc")),$(".content .tab").eq(e).find(".con").html(""),$(".content .tab").eq(e).find(".infinite-scroll-preloader").show(),n.config.pageNum[n.config.sort]=1),n.config.param.pageNum=n.config.pageNum[n.config.sort],0===$(".content .tab").eq(e).find(".item").size()?n.sendRequest(n.config.url,n.config.param,n.config.sort):n.config.loading=!1})},getData:function(){var e=this,t=this.config.url;this.sendRequest(t,e.config.param,"all")},sendRequest:function(e,t,o){var n=this;$.ajax({url:e,type:"get",data:t,contentType:"application/json",dataType:"json",success:function(e){"100"===e.code&&(n.config.total[n.config.sort]=e.page.total,n.config.pageSize[n.config.sort]+=e.page.list.length,n.render(e.page.list),n.config.loading=!1,e.page.list.length<10&&$(".infinite-scroll-preloader").eq(n.config.tabs).hide())},error:function(){}})},scroll:function(){var e=this;$(".content").on("infinite",function(){if(e.config.loading)return!1;e.config.loading=!0;var t=e.config.total[e.config.sort];return e.config.pageSize[e.config.sort]>=t?($(".infinite-scroll-preloader").eq(e.config.tabs).hide(),!1):(e.config.pageNum[e.config.sort]=++e.config.param.pageNum,void e.sendRequest(e.config.url,e.config.param,"latest"))})},render:function(e){var t=s.compile(r),o=t({data:e}),n=this.config.tabs;$(".content .tab").eq(n).find(".con").append(o),$(".item").on("click",function(){var e=$(this).attr("data-pcode"),t=$(this).attr("data-scode");$.router.load("../detail/detail.html?productCode="+e+"&shopCode="+t)})},getShopInfo:function(e,t){$.ajax({url:i.config.serverBase+"/api/shop/info.json",type:"GET",data:{shopCode:e},success:function(e){if(e&&"100"===e.code){var o=t+"_"+e.shopInfo.shopName,i=t+","+e.shopInfo.shopName+", 特色旅游,高端旅游,酷鸟。",s=t+"_"+e.shopInfo.shopName+"，酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。";""===t&&(o=e.shopInfo.shopName+"_酷鸟",i=e.shopInfo.shopName+", 特色旅游,高端旅游,酷鸟。",s=e.shopInfo.shopName+"，酷鸟为"+e.shopInfo.shopName+"的特色旅游项目提供专业权威的电商解决方案。"),n(o,i,s);var a="";"undefined"!=typeof e.shopInfo.shopLogoImg&&(a=e.shopInfo.shopLogoImg),o=e.shopInfo.shopName+"_"+t;var r=window.location.href;p.initWeixin(r),wx.ready(function(){p.onMenuShareTimeline(o,r,a),p.onMenuShareAppMessage(o,r,a," ")})}}})}};$(document).on("pageInit","#indexShop",function(e,t,o){d.init()}),$(document).on("pageInit","#indexShopLatest",function(e,t,o){l.init("shopLatest")}),$(document).on("pageInit","#indexProductRecommend",function(e,t,o){l.init("shopRecommend")}),$(document).on("pageInit","#indexShopMerchant",function(e,t,o){h.init()}),$(document).on("pageInit","#indexProductCatalog",function(e,t,o){f.init("productCatalog")}),$(document).on("pageInit","#indexAllProducts",function(e,t,o){f.init("allProducts")})},{"../common/etpl.js":1,"../common/global.js":2,"../common/share.js":3,"./tpl/contactMerchant.html":5,"./tpl/productItem.html":6,"./tpl/shopIndex.html":7}],5:[function(e,t,o){t.exports='<div class="shop-merchant">    <div class="info">        <div class="info-head clearfix">            <div class="info-left">                <!-- if: ${shopLogoImg} -->                <img src="${shopLogoImg}" class="merchant-logo" width="80" />                <!-- else -->                <img src="../../images/home/kooniao.jpg" class="merchant-logo"  width="90"/>                <!-- /if -->            </div>            <div class="info-right">                <h1>${shopName}</h1>                <div class="star">                    <!-- if: ${shopScore} > 0  -->                    <ul>                        <!-- for: ${scoreList} as ${scoreItem} -->                        <li><span style="width:${scoreItem};"></span></li>                        <!-- /for -->                    </ul>                    <span class="score">${shopScore}分</span>                    <!-- /if -->                </div>            </div>        </div>         <!-- if: ${mobiles[0]}  -->        <div class="phone">            <div class="number">联系电话（默认）：${mobiles[0]}</div>            <a class="call external" href="tel:${mobiles[0]}"></a>        </div>         <!-- /if -->           <!-- if: ${mobiles[1]}  -->        <div class="phone">            <div class="number">联系电话1：${mobiles[1]}</div>            <a class="call external" href="tel:${mobiles[1]}"></a>        </div>         <!-- /if -->           <!-- if: ${mobiles[2]}  -->        <div class="phone">            <div class="number">联系电话2：${mobiles[2]}</div>            <a class="call external" href="tel:${mobiles[2]}"></a>        </div>         <!-- /if -->        <!-- if: ${address} -->        <div class="address">            <div class="dizhi">实体店地址：${province}${city}${zone}${address}</div>        </div>        <!-- /if -->        <div class="introduce">            ${shopIntroduction}        </div>    </div></div>';
},{}],6:[function(e,t,o){t.exports='<!-- for: ${data} as ${item},${index} --><div class="item" data-pcode="${item.code}" data-scode="${item.shopCode}">\t<a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>\t  <img src="${item.cover}" alt="${item.dataname}" />\t</a>\t<h4><a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>${item.name}</a></h4>\t<p><span>￥${item.minPrice}</span></p></div><!-- /for -->'},{}],7:[function(e,t,o){t.exports='<!-- if: ${shopInfo.shopStatus} === 1 --><!-- if: ${shopInfo} --><div class="shop-header">    <div class="con">      <div class="user">          <a href="#"></a>      </div>      <div class="con-inner">\t  <!-- if: ${shopInfo.shopLogoImg} -->        <img src="${shopInfo.shopLogoImg}"/>\t\t<!-- else -->\t\t<img src="../../images/home/shop_default.jpg" />\t\t<!-- /if -->        <div class="name">${shopInfo.shopName}</div>        <!-- if: ${shopInfo.score} > 0 -->        <!-- <p>          <span class="score">            <em style="width:${shopInfo.score|scoreFormat}%;"></em>          </span>          <span>${shopInfo.score}</span>        </p> -->        <!-- /if -->        <div class="collection">收藏</div>      </div>    </div></div><div class="buttons-tab">      <a href="index.html?shopCode=${shopInfo.shopCode}" class="button active">店铺首页</a>      <a href="allProducts.html?shopCode=${shopInfo.shopCode}" class="button">全部产品</a>      <!-- if:${productList} -->      <a href="newRelease.html?shopCode=${shopInfo.shopCode}" class="button">最新上架</a>      <!-- /if -->      <!-- if:${recommendProduct} -->      <a href="recommended.html?shopCode=${shopInfo.shopCode}" class="button">推荐产品</a>      <!-- /if --> </div><!-- /if --><!-- if:${advImg} --><div class="dpbanner" id="banner">    <div class="swiper-container" data-space-between=\'10\'>      <div class="swiper-wrapper">        <!-- for: ${advImg} as ${item},${index} -->        <div class="swiper-slide">          <!-- if:${item.productCode} !== \'\' -->          <a href="../detail/detail.html?productCode=${item.productCode}&shopCode=${item.shopCode}"><img src="${item.imgSrc}" alt=""></a>          <!-- else -->          <a href="#"><img src="${item.imgSrc}" alt=""></a>          <!-- /if -->        </div>        <!-- /for -->      </div>      <div class="swiper-pagination"></div>    </div></div>    <!-- /if --><!-- if: ${recommendProduct}--><div class="recommend-pro">  <h2>推荐产品</h2>  <!-- for: ${recommendProduct} as ${item}, ${index} -->  <div class="item" data-pcode="${item.code}" data-scode="${item.shopCode}">    <a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>      <img src="${item.cover}" alt="${item.name}">    </a>    <h4><a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>${item.name}</a></h4>    <p><span>￥${item.minPrice}</span></p>  </div>  <!-- /for --></div><!-- /if --><!-- if: ${productList} --><div class="latest-pro">  <h2>最新上架</h2>  <!-- for: ${productList} as ${item}, ${index} -->  <div class="item" data-pcode="${item.code}" data-scode="${item.shopCode}">    <a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>      <img src="${item.cover}" alt="${item.name}">    </a>    <h4><a href="../detail/detail.html?productCode=${item.code}&shopCode=${item.shopCode}" external>${item.name}</a></h4>    <p><span>￥${item.minPrice}</span></p>  </div>  <!-- /for --></div><!-- /if --><div class="all-shop-pro">  <a href="allProducts.html?shopCode=${shopInfo.shopCode}">查看全部产品</a></div><div class="dpfooter">    <div class="foo">        <p>          <span>酷鸟</span>          <span>kooniao.com</span>        </p>        <p>酷鸟提供技术支持</p>    </div></div>    <!-- else --><div class="shopIndex-pause-container">  <div class="con">    <div class="shop-icon">    </div>    <h2>店铺暂停营业</h2>    <p>      <a href="#" class="knIndex">酷鸟首页</a>      <a href="#" extral class="userCenter">用户中心</a>    </p>  </div></div><!-- /if -->'},{}]},{},[4]);