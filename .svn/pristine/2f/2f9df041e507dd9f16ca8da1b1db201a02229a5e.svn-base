!function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){!function(e){function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function o(){this.raw=[],this.length=0}function i(){return"___"+_++}function s(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function a(e){return j[e]}function c(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function p(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function d(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,n){return t[n-0+1]})}function l(e){return e=e.replace(/^\s*\*/,""),d('gv({0},["{1}"])',c(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function u(e,t,n,r,o,i){for(var s=n.length,a=e.split(t),c=0,p=[],d=0,l=a.length;l>d;d++){var u=a[d];if(d){var f=1;for(c++;;){var h=u.indexOf(n);if(0>h){p.push(c>1&&f?t:"",u);break}if(c=r?c-1:0,p.push(c>0&&f?t:"",u.slice(0,h),c>0?n:""),u=u.slice(h+s),f=0,0===c)break}0===c&&(o(p.join("")),i(u),p=[])}else u&&i(u)}c>0&&p.length>0&&(i(t),i(p.join("")))}function f(e,t,n){var r,o=[],i=t.options,s="",a="",p="",d="";return n&&(s="ts(",a=")",p=F,d=D,r=i.defaultFilter),u(e,i.variableOpen,i.variableClose,1,function(e){n&&e.indexOf("|")<0&&r&&(e+="|"+r);var i=e.indexOf("|"),c=(i>0?e.slice(0,i):e).replace(/^\s+/,"").replace(/\s+$/,""),u=i>0?e.slice(i+1):"",h=0===c.indexOf("*"),g=[h?"":s,l(c),h?"":a];if(u){u=f(u,t);for(var m=u.split("|"),y=0,v=m.length;v>y;y++){var $=m[y];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test($)&&(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&g.push(",",RegExp.$3),g.push(")"))}}o.push(p,g.join(""),d)},function(e){o.push(p,n?c(e):e,d)}),o.join("")}function h(e,t){this.value=e,this.engine=t}function g(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function m(e,t){var n=e.stack,r=t?n.find(function(e){return e instanceof t}):n.bottom();if(r){for(var o;(o=n.top())!==r;){if(!o.autoClose)throw new Error(o.type+" must be closed manually: "+o.value);o.autoClose(e)}r.close(e)}return r}function y(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,g.call(this,e,t),this.blocks={}}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,g.call(this,e,t),this.cloneProps=["name"]}function $(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,g.call(this,e,t),this.cloneProps=["name","state","blocks","target"],this.blocks={}}function C(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,g.call(this,e,t),this.cloneProps=["name","expr"]}function w(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,e,t),this.cloneProps=["name","args"]}function x(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,e,t),this.cloneProps=["name","args"]}function S(e,t){var n=new RegExp(d("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",p(t.options.variableOpen),p(t.options.variableClose)),"i");if(!n.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,g.call(this,e,t),this.cloneProps=["list","item","index"]}function b(e,t){g.call(this,e,t)}function E(e,t){b.call(this,e,t)}function R(e,t){g.call(this,e,t)}function O(e,t){t.target=e;var n=t.engine,r=e.name;if(n.targets[r])switch(n.options.namingConflict){case"override":n.targets[r]=e,t.targets.push(r);case"ignore":break;default:throw new Error("[ETPL_TARGET_EXISTS]"+r)}else n.targets[r]=e,t.targets.push(r)}function I(e,t){M[e]=t,t.prototype.type=e}function k(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]*)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=r({},P)}function B(e,t){function n(){var e;if(d.length>0&&(e=d.join(""))){var n=new h(e,t);n.beforeAdd(p),c.top().addChild(n),d=[],t.options.strip&&p.current instanceof g&&(n.value=e.replace(/^[\x20\t\r]*\n/,"")),p.current=n}}var r,i=t.options.commandOpen,s=t.options.commandClose,a=t.options.commandSyntax,c=new o,p={engine:t,targets:[],stack:c,target:null},d=[];return u(e,i,s,0,function(e){var o,c=a.exec(e);if(c&&(o=c[2]||"target")&&(r=M[o.toLowerCase()])&&"function"==typeof r){n();var l=p.current;t.options.strip&&l instanceof h&&(l.value=l.value.replace(/\r?\n[\x20\t]*$/,"\n")),c[1]?l=m(p,r):(l=new r(c[3],t),"function"==typeof l.beforeOpen&&l.beforeOpen(p),l.open(p)),p.current=l}else/^\s*\/\//.test(e)||d.push(i,e,s);r=null},function(e){d.push(e)}),n(),m(p),p.targets}o.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var n=this.raw[t];if(e(n))return n}}};var _=178245,j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},P={html:function(e){return e.replace(/[&<>"']/g,a)},url:encodeURIComponent,raw:function(e){return e}},A='var r="";',F="r+=",D=";",T="return r;";"undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(A="var r=[],ri=0;",F="r[ri++]=",T='return r.join("");'),h.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;return!e||t.strip&&/^\s*$/.test(e)?"":f(e,this.engine,1)},clone:function(){return this}},g.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){e.stack.top()===this&&e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,n=0;n<t.length;n++)e.push(t[n].getRendererBody());return e.join("")},clone:function(){for(var e=this.constructor,t=new e(this.value,this.engine),n=0,r=this.children.length;r>n;n++)t.addChild(this.children[n].clone());for(var n=0,r=this.cloneProps.length;r>n;n++){var o=this.cloneProps[n];t[o]=this[o]}return t}};var N='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';s(y,g),s(v,g),s($,g),s(C,g),s(w,g),s(x,g),s(S,g),s(b,g),s(E,b),s(R,b);var L={READING:1,READED:2,APPLIED:3,READY:4};$.prototype.applyMaster=y.prototype.applyMaster=function(e){function t(e){var r=e.children;if(r instanceof Array)for(var o=0,i=r.length;i>o;o++){var s=r[o];s instanceof v&&n[s.name]&&(s=r[o]=n[s.name]),t(s)}}if(this.state>=L.APPLIED)return 1;var n=this.blocks,r=this.engine.targets[e];if(r){if(r.applyMaster(r.master))return this.children=r.clone().children,t(this),this.state=L.APPLIED,1}else if("error"===this.engine.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+e+", when extended by "+(this.target?this.target.name:this.name))},y.prototype.isReady=function(){function e(o){for(var i=0,s=o.children.length;s>i;i++){var a=o.children[i];if(a instanceof $){var c=t.targets[a.name];if(!c&&"error"===t.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+a.name+", when imported by "+n);r=r&&c&&c.isReady(t)}else a instanceof g&&e(a)}}if(this.state>=L.READY)return 1;var t=this.engine,n=this.name,r=1;return this.applyMaster(this.master)?(e(this),r&&(this.state=L.READY),r):void 0},y.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[N,A,this.getRendererBody(),T].join("\n")),t=this.engine;return this.renderer=function(n){return e(n,t)},this.renderer}return null},y.prototype.open=function(e){m(e),g.prototype.open.call(this,e),this.state=L.READING,O(this,e)},C.prototype.open=x.prototype.open=function(e){e.stack.top().addChild(this)},v.prototype.open=function(e){g.prototype.open.call(this,e),e.stack.find(function(e){return e.blocks}).blocks[this.name]=this},E.prototype.open=function(e){var t=new R;t.open(e);var n=m(e,b);n.addChild(this),e.stack.push(this)},R.prototype.open=function(e){var t=m(e,b);t.addChild(this),e.stack.push(this)},$.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,g.prototype.open.call(this,e),this.state=L.READING},x.prototype.close=C.prototype.close=function(){},$.prototype.close=function(e){g.prototype.close.call(this,e),this.state=L.READED},y.prototype.close=function(e){g.prototype.close.call(this,e),this.state=this.master?L.READED:L.APPLIED,e.target=null},$.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(e)},x.prototype.beforeOpen=$.prototype.beforeOpen=C.prototype.beforeOpen=S.prototype.beforeOpen=w.prototype.beforeOpen=v.prototype.beforeOpen=b.prototype.beforeOpen=h.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new y(i(),e.engine);t.open(e)}},$.prototype.getRendererBody=function(){return this.applyMaster(this.name),g.prototype.getRendererBody.call(this)},x.prototype.getRendererBody=function(){return d("{0}engine.render({2},{{3}}){1}",F,D,c(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,n){return(t||"")+c(n)+":"}))},C.prototype.getRendererBody=function(){return this.expr?d("v[{0}]={1};",c(this.name),f(this.expr,this.engine)):""},b.prototype.getRendererBody=function(){return d("if({0}){{1}}",f(this.value,this.engine),g.prototype.getRendererBody.call(this))},R.prototype.getRendererBody=function(){return d("}else{{0}",g.prototype.getRendererBody.call(this))},S.prototype.getRendererBody=function(){return d('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),f(this.list,this.engine),c(this.index||i()),c(this.item),i(),i(),g.prototype.getRendererBody.call(this))},w.prototype.getRendererBody=function(){var e=this.args;return d("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",A,T,F,D,g.prototype.getRendererBody.call(this),c(this.name),e?","+f(e,this.engine):"")};var M={};I("target",y),I("block",v),I("import",$),I("use",x),I("var",C),I("for",S),I("if",b),I("elif",E),I("else",R),I("filter",w),k.prototype.config=function(e){r(this.options,e)},k.prototype.compile=k.prototype.parse=function(e){if(e){var t=B(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},k.prototype.getRenderer=function(e){var t=this.targets[e];return t?t.getRenderer():void 0},k.prototype.render=function(e,t){var n=this.getRenderer(e);return n?n(t):""},k.prototype.addFilter=function(e,t){"function"==typeof t&&(this.filters[e]=t)};var q=new k;q.Engine=k,q.version="3.1.0","object"==typeof n&&"object"==typeof t?n=t.exports=q:"function"==typeof define&&define.amd?define(q):e.etpl=q}(this)},{}],2:[function(e,t,n){var r=function(){};r.prototype.getUrlParam=function(){for(var e=location.search.slice(1),t={},n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");t[o[0]]||(t[o[0]]=o[1])}return t},r.prototype.localStorage={get:function(e){var t="";if("undefined"==typeof localStorage[e])return!1;try{return t=JSON.parse(localStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(n){return localStorage[e]}},set:function(e,t){return"undefined"==typeof t?!1:(localStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof localStorage[e]?console.log("this item is not exit!"):delete localStorage[e]}},r.prototype.sessionStorage={get:function(e){var t="";if("undefined"==typeof sessionStorage[e])return"undefined";try{return t=JSON.parse(sessionStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(n){return sessionStorage[e]}},set:function(e,t){return"undefined"==typeof t?!1:(sessionStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof sessionStorage[e]?console.log("this item is not exit!"):delete sessionStorage[e]}},r.prototype.config={serverBase:"/m/",knIndex:"/m/nav/kn/index",loginHref:"/m/nav/login",logoutHref:"/m/nav/logout"},"object"==typeof t&&"object"==typeof t.exports?t.exports=new r:window.GlobalKuNiao=r},{}],3:[function(e,t,n){function r(e){var t=new Date(parseInt(e)),n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();return n}var o=e("../common/global.js"),i=e("../common/etpl.js"),s=e("./tpl/orderResult.html"),a=e("./tpl/paySuccess.html"),c=e("./tpl/paySuccessAlipay.html"),p={config:{orderCode:"",orderStatus:1,paymentCode:""},init:function(){var e=o.getUrlParam();return"undefined"==typeof e.orderCode?($.alert("该订单不存在哦!",function(){location.href=o.config.knIndex}),!1):(o.sessionStorage.set("orderCode",e.orderCode),this.config.orderCode=e.orderCode,this.config.paymentCode=e.paymentCode,this.addFilter(),this.getOrderInfo(),this.paySubmit(),void(navigator.userAgent.match(/MicroMessenger/gi)?this.config.payType="wechat":this.config.payType="alipay"))},getOrderInfo:function(){var e=this,t=o.config.serverBase+"api/order/details.json",n={orderCode:this.config.orderCode,orderStatus:this.config.orderStatus};$.ajax({url:t,type:"get",data:n,dataType:"json",success:function(t){"100"===t.code?e.render(t):"403"===t.code&&(location.href=o.config.loginHref)}})},render:function(e){var t=$(".suc-container");$("header .back").unbind("click").click(function(){var t=e.productList,n=e.shopInfo;t.length>0&&t[t.length-1].productSpu.trim().length>0&&n&&n.shopCode.trim().length>0?$.router.load("../detail/detail.html?productCode="+t[t.length-1].productSpu+"&shopCode="+n.shopCode):$(this).removeClass("external")});var n=i.compile(s),r=n(e);t.html(r),this.countdown(e)},addFilter:function(){i.addFilter("univalent",function(e,t){return e=Number(e),t=Number(t),0===e?0:e/t}),i.addFilter("isWechatNative",function(){return!!navigator.userAgent.match(/MicroMessenger/gi)}),i.addFilter("formatPrice",function(e){return e=parseInt(e),e.toFixed(0)}),i.addFilter("timeFormat",function(e,t){return""===e?"":r(e)})},paySubmit:function(){var e=this,t=$(".pay-btn");t.on("click",function(){$.showPreloader(),"wechat"===e.config.payType?e.wechatPay():e.alipay()})},alipay:function(){var e=o.config.serverBase+"api/knpay/pay/alipay/wap.json",t="http://"+location.host+"/shop/static/html/pay/paySuccessAlipay.html?orderCode="+this.config.orderCode,n={invoice_id:this.config.paymentCode,order_id:this.config.orderCode,return_url:t};$.ajax({url:e,type:"get",dataType:"json",data:n,success:function(e){"100"===e.code?($(".content").append(e.htmlText),$("#alipaysubmit").submit()):($.hidePreloader(),$.toast(e.msg))}})},wechatPay:function(){var e={invoice_id:p.config.paymentCode,order_id:p.config.orderCode};$.hidePreloader(),u.init(e)},countdown:function(e){var t=$(".countdown").find(".countdown-time");if(console.log(e),t.size()>0){var n=parseInt(e.userOrderBean.orderTime,10)/1e3,r=new Date(e.currTime).getTime()/1e3,o=86400,i=o-(r-n);if(i>0)var s=setInterval(function(){var e=Math.floor(i/3600),n=Math.floor((i-3600*e)/60),r=Math.floor(i-3600*e-60*n);t.html(e+"时"+n+"分"+r+"秒"),i--,0>=i&&(clearInterval(s),$(".countdown").remove())},1e3);else $(".countdown").remove(),$(".pay-btn").addClass("disabled")}}},d={config:{orderCode:"",orderStatus:4,shopCode:""},init:function(){var e=o.getUrlParam(),t=o.localStorage.get("shopCode")||1,n=e.orderCode;"undefined"==typeof n&&$.alert("该页面已经失效！",function(){location.href=o.config.knIndex}),this.config.orderCode=n,this.config.shopCode=t,this.addFilter(),this.getOrderInfo()},getOrderInfo:function(){var e=this,t=o.config.serverBase+"api/order/details.json",n={orderCode:this.config.orderCode,orderStatus:this.config.orderStatus};$.ajax({url:t,type:"get",data:n,dataType:"json",success:function(t){"100"===t.code?e.render(t):"403"===t.code&&$.alert("你还未登陆哦！请先登陆",function(){location.href=o.config.loginHref})}})},render:function(e){var t=$(".suc-container");$("header .back").click(function(){var t=e.productList,n=e.shopInfo;t.length>0&&t[t.length-1].productSpu.trim().length>0&&n&&n.shopCode.trim().length>0?window.location.href="../detail/detail.html?productCode="+t[t.length-1].productSpu+"&shopCode="+n.shopCode:$(this).removeClass("external")});var n=i.compile(a),r=n(e);t.html(r),$(".item").on("click",function(){var e=$(this).attr("data-ordercode");window.location.href="../home/memberOrderDetail.html?orderCode="+e+"&orderStatus=4&type=3"}),$("#paySuccess").on("click",".pay-btn",function(){window.location.href="../index/index.html?shopCode="+e.shopInfo.shopCode})},addFilter:function(){i.addFilter("univalent",function(e,t){return e=Number(e),t=Number(t),0===e?0:e/t}),i.addFilter("formatPrice",function(e){return e=parseInt(e),e.toFixed(0)}),i.addFilter("timeFormat",function(e,t){return""===e?"":r(e)})},delOrderInfo:function(){o.sessionStorage.del("orderInfo")}},l={config:{orderCode:"",orderStatus:4,shopCode:""},init:function(){var e=o.getUrlParam(),t=o.localStorage.get("shopCode")||1,n=e.orderCode;"undefined"==typeof n&&$.alert("该页面已经失效！",function(){location.href=o.config.knIndex}),this.config.orderCode=n,this.config.shopCode=t,this.addFilter(),this.getOrderInfo()},getOrderInfo:function(){var e=this,t=o.config.serverBase+"api/order/details.json",n={orderCode:this.config.orderCode,orderStatus:this.config.orderStatus};$.ajax({url:t,type:"get",data:n,dataType:"json",success:function(t){"100"===t.code?e.render(t):"403"===t.code&&$.alert("你还未登陆哦！请先登陆",function(){location.href=o.config.loginHref})}})},render:function(e){var t=$(".suc-container");$("header .back").click(function(){var t=e.productList,n=e.shopInfo;t.length>0&&t[t.length-1].productSpu.trim().length>0&&n&&n.shopCode.trim().length>0?window.location.href="../detail/detail.html?productCode="+t[t.length-1].productSpu+"&shopCode="+n.shopCode:$(this).removeClass("external")});var n=i.compile(c),r=n(e);t.html(r),$(".item").on("click",function(){var e=$(this).attr("data-ordercode");window.location.href="../home/memberOrderDetail.html?orderCode="+e+"&orderStatus=4&type=3"}),$("#paySuccessAlipay").on("click",".pay-btn",function(){window.location.href="../index/index.html?shopCode="+e.shopInfo.shopCode})},addFilter:function(){i.addFilter("univalent",function(e,t){return e=Number(e),t=Number(t),0===e?0:e/t}),i.addFilter("formatPrice",function(e){return e=parseInt(e),e.toFixed(0)}),i.addFilter("timeFormat",function(e,t){return""===e?"":r(e)})},delOrderInfo:function(){o.sessionStorage.del("orderInfo")}},u={params:{},init:function(e){$.ajax({url:o.config.serverBase+"/api/knpay/pay/wxpay/jsapi.json",type:"GET",data:e,success:function(e){e&&"100"===e.code?(u.params.nonceStr=e.nonceStr,u.params.paySign=e.paySign,u.params["package"]=e.prepayId,u.params.signType=e.signType,u.params.timeStamp=e.timeStamp,u.params.appId=e.appId,u.addListener()):"404"===e.code?$.confirm("您还没有绑定微信呢，现在绑定？",function(){window.location.href=o.config.serverBase+"nav/wxOAuth/bind"}):$.toast("error:"+e.msg)}})},jsApiCall:function(){WeixinJSBridge.invoke("getBrandWCPayRequest",u.params,function(e){"get_brand_wcpay_request:ok"==e.err_msg?u.queryOrder(p.config.paymentCode,p.config.orderCode):"get_brand_wcpay_request:cancel"==e.err_msg?$.toast("交易取消"):"get_brand_wcpay_request:fail"==e.err_msg?$.toast("交易失败"):$.toast(e.err_msg)})},addListener:function(){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",this.jsApiCall,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",this.jsApiCall),document.attachEvent("onWeixinJSBridgeReady",this.jsApiCall)):this.jsApiCall()},queryOrder:function(e,t){$.ajax({url:o.config.serverBase+"api/knpay/query.json",type:"GET",data:{invoice_id:e,order_id:t},success:function(e){if(e&&"100"===e.code){var n=e.isPayed;n?window.location.href="paySuccess.html?orderCode="+t:$.toast("未付款")}else $.toast("error:"+e.msg)}})},getParams:function(){$.ajax({url:"api/knpay/query.json",type:"GET",data:{invoice_id:invoiceId,payment_method:"wechat",payment_scene:"JSAPI"},success:function(e){e&&"100"===e.code||$.toast("error:"+e.msg)}})}};$(document).on("pageInit","#payOrderResult",function(e,t,n){p.init()}),$(document).on("pageInit","#paySuccess",function(e,t,n){d.init()}),$(document).on("pageInit","#paySuccessAlipay",function(e,t,n){l.init()})},{"../common/etpl.js":1,"../common/global.js":2,"./tpl/orderResult.html":4,"./tpl/paySuccess.html":5,"./tpl/paySuccessAlipay.html":6}],4:[function(e,t,n){t.exports='<div class="countdown">	请在<span class="countdown-time" data-time="${userOrderBean.orderTime}"></span>内支付，超时未支付将取消订单</div><div class="con">	<p class="order-code">		订单编码：${userOrderBean.orderCode}	</p>	<div class="info-con">		<!-- for: ${productList} as ${item},${index} -->		<div class="item" data-ordercode="${item.productCode}">			<div class="info">				<h2><a href="../detail/detail.html?shopCode=${shopInfo.shopCode}&productCode=${item.productCode}">${item.productName}</a></h2>				<p>商品规格：					<span>${item.spec}</span>				</p>				<!-- if: ${userOrderBean.useDate} -->				<p class="date">使用日期：${userOrderBean.useDate|timeFormat}</p>				<!-- /if -->			</div>			<p class="price">				<span>￥${item.price|univalent(${item.price},${item.num})}</span>				<span>x ${item.num}</span>			</p>		</div>		<!-- /for -->	</div>	<p class="total-price">		应付金额：<span>￥${userOrderBean.orderCountPrice}</span>	</p></div><div class="pay-type">	<h3>支付方式</h3>	<div class="pay-list">		<!-- if: ${\'\'|isWechatNative} -->		<p class="wechatpay">微信支付</p>		<!-- else -->			<p class="alipay selected">支付宝支付</p>		<!-- /if -->	</div></div>'},{}],5:[function(e,t,n){t.exports='<div class="con">	<p class="order-code">		订单编码：${userOrderBean.orderCode}	</p>	<div class="info-con">		<!-- for: ${productList} as ${item},${index} -->		<div class="item" data-ordercode="${userOrderBean.orderCode}">			<div class="info">				<h2>${item.productName}</h2>				<p>商品规格：					<span>${item.spec}</span>				</p>				<p>预定数量：					<span>X${item.num}</span>				</p>				<!-- if:${item.useDate} -->				<p class="date">使用日期：${item.useDate}</p>				<!-- /if -->				<!-- if:${userOrderBean.useDate} -->				<p class="date">使用日期：${userOrderBean.useDate | timeFormat}</p>				<!-- /if -->			</div>			<div class="orderArrow">				<span class="icon icon-right"></span>			</div>		</div>		<!-- /for -->	</div>	<p>		支付金额：<span>￥${userOrderBean.orderCountPrice | formatPrice}</span>	</p>	<p>		支付方式：<span>微信</span>	</p></div>'},{}],6:[function(e,t,n){t.exports='<div class="con">	<p class="order-code">		订单编码：${userOrderBean.orderCode}	</p>	<div class="info-con">		<!-- for: ${productList} as ${item},${index} -->		<div class="item" data-ordercode="${userOrderBean.orderCode}">			<div class="info">				<h2>${item.productName}</h2>				<p>商品规格：					<span>${item.spec}</span>				</p>				<p>预定数量：					<span>X${item.num}</span>				</p>				<!-- if:${userOrderBean.useDate} -->				<p class="date">使用日期：${userOrderBean.useDate | timeFormat}</p>				<!-- /if -->			</div>			<div class="orderArrow">				<span class="icon icon-right"></span>			</div>		</div>		<!-- /for -->	</div>	<p>		支付金额：<span>￥${userOrderBean.orderCountPrice | formatPrice}</span>	</p>	<p>		支付方式：<span>支付宝</span>	</p></div>'},{}]},{},[3]);