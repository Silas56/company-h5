!function e(t,o,n){function i(s,a){if(!o[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var p=o[s]={exports:{}};t[s][0].call(p.exports,function(e){var o=t[s][1][e];return i(o?o:e)},p,p.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,o){!function(e){function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function i(){this.raw=[],this.length=0}function r(){return"___"+P++}function s(e,t){var o=new Function;o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}function a(e){return T[e]}function c(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function l(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function p(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,o){return t[o-0+1]})}function d(e){return e=e.replace(/^\s*\*/,""),p('gv({0},["{1}"])',c(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function u(e,t,o,n,i,r){for(var s=o.length,a=e.split(t),c=0,l=[],p=0,d=a.length;d>p;p++){var u=a[p];if(p){var f=1;for(c++;;){var h=u.indexOf(o);if(0>h){l.push(c>1&&f?t:"",u);break}if(c=n?c-1:0,l.push(c>0&&f?t:"",u.slice(0,h),c>0?o:""),u=u.slice(h+s),f=0,0===c)break}0===c&&(i(l.join("")),r(u),l=[])}else u&&r(u)}c>0&&l.length>0&&(r(t),r(l.join("")))}function f(e,t,o){var n,i=[],r=t.options,s="",a="",l="",p="";return o&&(s="ts(",a=")",l=A,p=F,n=r.defaultFilter),u(e,r.variableOpen,r.variableClose,1,function(e){o&&e.indexOf("|")<0&&n&&(e+="|"+n);var r=e.indexOf("|"),c=(r>0?e.slice(0,r):e).replace(/^\s+/,"").replace(/\s+$/,""),u=r>0?e.slice(r+1):"",h=0===c.indexOf("*"),m=[h?"":s,d(c),h?"":a];if(u){u=f(u,t);for(var g=u.split("|"),v=0,y=g.length;y>v;v++){var $=g[v];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test($)&&(m.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&m.push(",",RegExp.$3),m.push(")"))}}i.push(l,m.join(""),p)},function(e){i.push(l,o?c(e):e,p)}),i.join("")}function h(e,t){this.value=e,this.engine=t}function m(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function g(e,t){var o=e.stack,n=t?o.find(function(e){return e instanceof t}):o.bottom();if(n){for(var i;(i=o.top())!==n;){if(!i.autoClose)throw new Error(i.type+" must be closed manually: "+i.value);i.autoClose(e)}n.close(e)}return n}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,m.call(this,e,t),this.blocks={}}function y(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,m.call(this,e,t),this.cloneProps=["name"]}function $(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,m.call(this,e,t),this.cloneProps=["name","state","blocks","target"],this.blocks={}}function _(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,m.call(this,e,t),this.cloneProps=["name","expr"]}function b(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,m.call(this,e,t),this.cloneProps=["name","args"]}function x(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,m.call(this,e,t),this.cloneProps=["name","args"]}function k(e,t){var o=new RegExp(p("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",l(t.options.variableOpen),l(t.options.variableClose)),"i");if(!o.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,m.call(this,e,t),this.cloneProps=["list","item","index"]}function C(e,t){m.call(this,e,t)}function w(e,t){C.call(this,e,t)}function S(e,t){m.call(this,e,t)}function R(e,t){t.target=e;var o=t.engine,n=e.name;if(o.targets[n])switch(o.options.namingConflict){case"override":o.targets[n]=e,t.targets.push(n);case"ignore":break;default:throw new Error("[ETPL_TARGET_EXISTS]"+n)}else o.targets[n]=e,t.targets.push(n)}function I(e,t){z[e]=t,t.prototype.type=e}function E(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]*)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=n({},U)}function j(e,t){function o(){var e;if(p.length>0&&(e=p.join(""))){var o=new h(e,t);o.beforeAdd(l),c.top().addChild(o),p=[],t.options.strip&&l.current instanceof m&&(o.value=e.replace(/^[\x20\t\r]*\n/,"")),l.current=o}}var n,r=t.options.commandOpen,s=t.options.commandClose,a=t.options.commandSyntax,c=new i,l={engine:t,targets:[],stack:c,target:null},p=[];return u(e,r,s,0,function(e){var i,c=a.exec(e);if(c&&(i=c[2]||"target")&&(n=z[i.toLowerCase()])&&"function"==typeof n){o();var d=l.current;t.options.strip&&d instanceof h&&(d.value=d.value.replace(/\r?\n[\x20\t]*$/,"\n")),c[1]?d=g(l,n):(d=new n(c[3],t),"function"==typeof d.beforeOpen&&d.beforeOpen(l),d.open(l)),l.current=d}else/^\s*\/\//.test(e)||p.push(r,e,s);n=null},function(e){p.push(e)}),o(),g(l),l.targets}i.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var o=this.raw[t];if(e(o))return o}}};var P=178245,T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={html:function(e){return e.replace(/[&<>"']/g,a)},url:encodeURIComponent,raw:function(e){return e}},B='var r="";',A="r+=",F=";",O="return r;";"undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(B="var r=[],ri=0;",A="r[ri++]=",O='return r.join("");'),h.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;return!e||t.strip&&/^\s*$/.test(e)?"":f(e,this.engine,1)},clone:function(){return this}},m.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){e.stack.top()===this&&e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,o=0;o<t.length;o++)e.push(t[o].getRendererBody());return e.join("")},clone:function(){for(var e=this.constructor,t=new e(this.value,this.engine),o=0,n=this.children.length;n>o;o++)t.addChild(this.children[o].clone());for(var o=0,n=this.cloneProps.length;n>o;o++){var i=this.cloneProps[o];t[i]=this[i]}return t}};var q='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';s(v,m),s(y,m),s($,m),s(_,m),s(b,m),s(x,m),s(k,m),s(C,m),s(w,C),s(S,C);var N={READING:1,READED:2,APPLIED:3,READY:4};$.prototype.applyMaster=v.prototype.applyMaster=function(e){function t(e){var n=e.children;if(n instanceof Array)for(var i=0,r=n.length;r>i;i++){var s=n[i];s instanceof y&&o[s.name]&&(s=n[i]=o[s.name]),t(s)}}if(this.state>=N.APPLIED)return 1;var o=this.blocks,n=this.engine.targets[e];if(n){if(n.applyMaster(n.master))return this.children=n.clone().children,t(this),this.state=N.APPLIED,1}else if("error"===this.engine.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+e+", when extended by "+(this.target?this.target.name:this.name))},v.prototype.isReady=function(){function e(i){for(var r=0,s=i.children.length;s>r;r++){var a=i.children[r];if(a instanceof $){var c=t.targets[a.name];if(!c&&"error"===t.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+a.name+", when imported by "+o);n=n&&c&&c.isReady(t)}else a instanceof m&&e(a)}}if(this.state>=N.READY)return 1;var t=this.engine,o=this.name,n=1;return this.applyMaster(this.master)?(e(this),n&&(this.state=N.READY),n):void 0},v.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[q,B,this.getRendererBody(),O].join("\n")),t=this.engine;return this.renderer=function(o){return e(o,t)},this.renderer}return null},v.prototype.open=function(e){g(e),m.prototype.open.call(this,e),this.state=N.READING,R(this,e)},_.prototype.open=x.prototype.open=function(e){e.stack.top().addChild(this)},y.prototype.open=function(e){m.prototype.open.call(this,e),e.stack.find(function(e){return e.blocks}).blocks[this.name]=this},w.prototype.open=function(e){var t=new S;t.open(e);var o=g(e,C);o.addChild(this),e.stack.push(this)},S.prototype.open=function(e){var t=g(e,C);t.addChild(this),e.stack.push(this)},$.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,m.prototype.open.call(this,e),this.state=N.READING},x.prototype.close=_.prototype.close=function(){},$.prototype.close=function(e){m.prototype.close.call(this,e),this.state=N.READED},v.prototype.close=function(e){m.prototype.close.call(this,e),this.state=this.master?N.READED:N.APPLIED,e.target=null},$.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var o in this.blocks)this.target.blocks[o]=this.blocks[o];this.blocks={},this.close(e)},x.prototype.beforeOpen=$.prototype.beforeOpen=_.prototype.beforeOpen=k.prototype.beforeOpen=b.prototype.beforeOpen=y.prototype.beforeOpen=C.prototype.beforeOpen=h.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new v(r(),e.engine);t.open(e)}},$.prototype.getRendererBody=function(){return this.applyMaster(this.name),m.prototype.getRendererBody.call(this)},x.prototype.getRendererBody=function(){return p("{0}engine.render({2},{{3}}){1}",A,F,c(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,o){return(t||"")+c(o)+":"}))},_.prototype.getRendererBody=function(){return this.expr?p("v[{0}]={1};",c(this.name),f(this.expr,this.engine)):""},C.prototype.getRendererBody=function(){return p("if({0}){{1}}",f(this.value,this.engine),m.prototype.getRendererBody.call(this))},S.prototype.getRendererBody=function(){return p("}else{{0}",m.prototype.getRendererBody.call(this))},k.prototype.getRendererBody=function(){return p('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',r(),f(this.list,this.engine),c(this.index||r()),c(this.item),r(),r(),m.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var e=this.args;return p("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",B,O,A,F,m.prototype.getRendererBody.call(this),c(this.name),e?","+f(e,this.engine):"")};var z={};I("target",v),I("block",y),I("import",$),I("use",x),I("var",_),I("for",k),I("if",C),I("elif",w),I("else",S),I("filter",b),E.prototype.config=function(e){n(this.options,e)},E.prototype.compile=E.prototype.parse=function(e){if(e){var t=j(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},E.prototype.getRenderer=function(e){var t=this.targets[e];return t?t.getRenderer():void 0},E.prototype.render=function(e,t){var o=this.getRenderer(e);return o?o(t):""},E.prototype.addFilter=function(e,t){"function"==typeof t&&(this.filters[e]=t)};var L=new E;L.Engine=E,L.version="3.1.0","object"==typeof o&&"object"==typeof t?o=t.exports=L:"function"==typeof define&&define.amd?define(L):e.etpl=L}(this)},{}],2:[function(e,t,o){var n=function(){};n.prototype.getUrlParam=function(){for(var e=location.search.slice(1),t={},o=e.split("&"),n=0;n<o.length;n++){var i=o[n].split("=");t[i[0]]||(t[i[0]]=i[1])}return t},n.prototype.localStorage={get:function(e){var t="";if("undefined"==typeof localStorage[e])return!1;try{return t=JSON.parse(localStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(o){return localStorage[e]}},set:function(e,t){return"undefined"!=typeof t&&(localStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof localStorage[e]?console.log("this item is not exit!"):delete localStorage[e]}},n.prototype.sessionStorage={get:function(e){var t="";if("undefined"==typeof sessionStorage[e])return"undefined";try{return t=JSON.parse(sessionStorage[e]),"undefined"!=typeof t.value?t.value:t}catch(o){return sessionStorage[e]}},set:function(e,t){return"undefined"!=typeof t&&(sessionStorage[e]=JSON.stringify({value:t}),!0)},del:function(e){"undefined"==typeof sessionStorage[e]?console.log("this item is not exit!"):delete sessionStorage[e]}},n.prototype.config={serverBase:"/m/",knIndex:"/m/nav/kn/index",loginHref:"/m/nav/login",logoutHref:"/m/nav/logout"},"object"==typeof t&&"object"==typeof t.exports?t.exports=new n:window.GlobalKuNiao=n},{}],3:[function(e,t,o){var n=e("../common/global.js"),i=function(){};i.prototype.initWeixin=function(e){$.ajax({url:n.config.serverBase+"jsApi/ticket",type:"GET",data:{url:e},success:function(e){e&&"100"===e.code&&wx.config({debug:!1,appId:e.jsApiTicketBean.appId,timestamp:e.jsApiTicketBean.timestamp,nonceStr:e.jsApiTicketBean.nonceStr,signature:e.jsApiTicketBean.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage"]})}})},i.prototype.onMenuShareAppMessage=function(e,t,o,n){wx.onMenuShareAppMessage({title:e,desc:n,link:t,imgUrl:o,type:"",dataUrl:"",success:function(){},cancel:function(){}})},i.prototype.onMenuShareTimeline=function(e,t,o){wx.onMenuShareTimeline({title:e,link:t,imgUrl:o,success:function(){},cancel:function(){}})},i.prototype.wechat_sendAppMsg=function(e,t,o,n){WeixinJSBridge.invoke("sendAppMessage",{img_url:e,img_width:"200",img_height:"200",link:encodeURIComponent(t),desc:encodeURIComponent(o),title:encodeURIComponent(n)},function(e){"send_app_msg:confirm"==e.err_msg?$.toast("分享成功"):$.toast("分享失败")})},i.prototype.wechat_timeLine=function(e,t,o,n){WeixinJSBridge.invoke("shareTimeline",{img_url:e,img_width:"200",img_height:"200",link:encodeURIComponent(t),desc:encodeURIComponent(o),title:encodeURIComponent(n)},function(e){"share_timeline:ok"==e.err_msg?$.toast("分享成功"):$.toast("分享失败")})},i.prototype.qq_friends=function(e,t,o,n,i,r){"undefind"==typeof n&&""!==n||(n="1105220679");var s="http://openmobile.qq.com/api/check?page=shareindex.html&style=9&status_os=0&sdkp=0&action=shareToQQ";return s+="&site="+encodeURIComponent(e),s+="&title="+encodeURIComponent(t),s+="&imageUrl="+o,s+="&appid="+n,s+="&targetUrl="+encodeURIComponent(i),s+="&page_url="+encodeURIComponent(r)},i.prototype.qzone=function(e,t,o,n,i,r){var s="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(e);return s+="&title="+t,s+="&desc="+o,s+="&summary="+n,s+="&site="+i,s+="&pics="+encodeURIComponent(r)},i.prototype.weibo=function(e,t,o,n,i){var r="http://v.t.sina.com.cn/share/share.php?";return r+="appkey="+e,r+="&ralateUid="+t,r+="&title="+encodeURIComponent(o),r+="&url="+encodeURIComponent(n),r+="&pic="+i},"object"==typeof t&&"object"==typeof t.exports?t.exports=new i:window.KN_Share=i},{"../common/global.js":2}],4:[function(e,t,o){var n,i,r=e("../common/etpl.js"),s=e("./tpl/memberMyCollectionPro.html"),a=e("./tpl/memberMyCollectionShop.html"),c=e("../common/global.js"),l=e("../common/share.js"),p={params:{selectedProCode:"",selectedShopCode:"",selectDetailUrl:"",pageNum:1,pageNum2:1,maxItems:[]},init:function(){this.getProdFav(1,10),this.getShopFav(1,10),$(".content .datalist").html(""),i=!1,this.initShopFavButton()},initProdFavButton:function(){$("#tab1").find(".content-block").unbind("click").click(function(){var e=$(this).find(".productCode").val(),t=$(this).find(".shopCode").val();$.router.load("../detail/detail.html?shopCode="+t+"&productCode="+e)}),$("#tab1").find(".product_list_r_menu").unbind("click").click(function(e){var t=$(this).parent().parent().parent(),o=t.find(".productCode").val();p.params.selectedProCode=o;var n=t.find(".shopCode").val();p.params.selectedShopCode=n,p.params.selectDetailUrl="http://"+location.host+"/shop/static/html/detail/detail.html?shopCode="+n+"&productCode="+o;var i=t.find("img").attr("src"),r=t.find(".product_list_r_title").text();p.initShare(r,i,1),$(".menu_click_shade").css({display:"block"}),$(".click1").css({bottom:"0px"}).css({display:"block"}),$(".menu_click_bottom").unbind("click").click(function(){$(".menu_click_shade").css({display:"none"}),$(".click1").css({bottom:"-218px"})}),e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}),$(".productShare").unbind("click").click(function(){$(".myCollection_shade").css("display","block").css("bottom","0px"),$(".myCollection_share").css("display","block").css("bottom","0px")}),$(".share_bottom").unbind("click").click(function(){$(".myCollection_shade").css("display","none").css("bottom","-218px"),$(".myCollection_share").css("display","none").css("bottom","-218px")}),$(".prodCancelCollection").unbind("click").click(function(){var e={shopCode:p.params.selectedShopCode,spuCode:p.params.selectedProCode,favType:1,updateType:2};$.confirm("确定取消收藏？","",function(){$.ajax({url:c.config.serverBase+"api/user/updateFav.json",type:"POST",data:JSON.stringify(e),contentType:"application/json",success:function(e){e&&"100"==e.code?($.toast("取消收藏成功"),window.location.reload()):(e=JSON.parse(e),e&&"403"===e.code?window.location.href=c.config.loginHref:$.toast("error:"+e.msg))}})})}),$(".order").unbind("click").click(function(){$.ajax({url:c.config.serverBase+"api/product/base.json",type:"GET",data:{productCode:p.params.selectedProCode,shopCode:p.params.selectedShopCode},success:function(e){if(e&&"100"==e.code){$(".menu_click_shade").css({display:"none"}),$(".click1").css({bottom:"-218px"});var t=e.product,o={limitMinNum:t.limitMinNum,spuCode:p.params.selectedProCode,shopCode:p.params.selectedShopCode,name:t.title,productType:t.productType};1===e.product.shopStatus&&1===e.product.saleStatus?(c.sessionStorage.del("orderInfo"),c.sessionStorage.set("orderInfo",o),$.router.load("../pay/orderInfo.html?spuCode="+o.spuCode)):$.toast("该商品暂时不可售，敬请期待！")}else e=JSON.parse(e),e&&"403"===e.code?window.location.href=c.config.loginHref:$.toast("error:"+e.msg)}})})},initShopFavButton:function(){$("#tab2").find(".content-block").unbind("click").click(function(){var e=$(this).find(".shopCode").val();$.router.load("../index/index.html?shopCode="+e)}),$("#tab2").find(".product_list_r_menu").unbind("click").click(function(e){var t=$(this).parent().parent().parent(),o=t.find(".shopCode").val();p.params.selectedShopCode=o,p.params.selectDetailUrl=p.params.selectDetailUrl="http://"+location.host+"/shop/static/html/index/index.html?shopCode="+o;var n=t.find("img").attr("src"),i=t.find(".product_list_r_title").text();p.initShare(i,n),$(".menu_click_shade").css({display:"block"}),$(".click2").css({bottom:"0px"}).css({display:"block"}),$(".menu_click_bottom").unbind("click").click(function(){$(".menu_click_shade").css({display:"none"}),$(".click2").css({bottom:"-218px"})}),e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}),$(".shopShare").unbind("click").click(function(){$(".myCollection_shade").css("display","block").css("bottom","0px"),$(".myCollection_share").css("display","block").css("bottom","0px")}),$(".share_bottom").unbind("click").click(function(){$(".myCollection_shade").css("display","none").css("bottom","-218px"),$(".myCollection_share").css("display","none").css("bottom","-218px")}),$(".shopCancelCollection").unbind("click").click(function(){$.confirm("确定取消收藏？","",function(){var e={shopCode:p.params.selectedShopCode,favType:2,updateType:2};$.ajax({url:c.config.serverBase+"api/user/updateFav.json",type:"POST",data:JSON.stringify(e),contentType:"application/json",success:function(e){e&&"100"==e.code?($.toast("取消收藏成功"),window.location.reload()):(e=JSON.parse(e),e&&"403"===e.code?window.location.href=c.config.loginHref:$.toast("error:"+e.msg))}})})})},getProdFav:function(e,t){$.ajax({url:c.config.serverBase+"/api/user/getProdFav.json",type:"GET",cache:!1,data:{pageNum:e,pageSize:t},success:function(e){if(e&&"100"==e.code){if(i=!1,n=1,e.prodFavList.total<1)return $("#tab1 .datalist").html("<div class='nomore' style='text-align:center;font-size: 0.8rem;'>暂无数据<div>"),void $(".infinite-scroll-preloader").eq(n-1).hide();var o=e.prodFavList.prodInfoList;if(o&&o.length>0){p.params.maxItems[n]=e.prodFavList.total;var a=r.compile(s),l={myCollectionProduct:e,prodInfoList:o},d=a(l);if($("#tab1 .datalist").append(d),p.initProdFavButton(),$.refreshScroller(),t>=e.prodFavList.total){$(".infinite-scroll-preloader").eq(n-1).hide();var u=$(".infinite-scroll").eq(n-1),f=u.find(".nomore");return void(0===f.length&&u.find(".datalist").append("<div class='nomore' style='text-align:center;font-size: 0.8rem;'>---- 没有更多了 ----</div>"))}}}else if(e&&"403"===e.code){var h=location.href;h=encodeURIComponent(h),$.ajax({url:"/m/api/global/visited.json?url="+h,type:"get",dataType:"json",success:function(){window.location.href=c.config.loginHref}})}else $.toast("error:"+e.msg)}})},getShopFav:function(e,t){$.ajax({url:c.config.serverBase+" /api/user/getShopFav.json",type:"GET",cache:!1,data:{pageNum:e,pageSize:t},success:function(e){if(e&&"100"==e.code){if(i=!1,n=2,e.shopFavList.total<1)return $("#tab2 .datalist").html("<div class='nomore' style='text-align:center;font-size: 0.8rem;'>暂无数据<div>"),void $(".infinite-scroll-preloader").eq(n-1).hide();var o=e.shopFavList.shopInfoList;if(r.addFilter("scoreFormat",function(e,t){return e/5*100}),o&&o.length>0){p.params.maxItems[n]=e.shopFavList.total;var s=r.compile(a),l={myCollectionShop:e,shopInfoList:o},d=s(l);if($("#tab2 .datalist").append(d),p.initShopFavButton(),$.refreshScroller(),t>=e.shopFavList.total){$(".infinite-scroll-preloader").eq(n-1).hide();var u=$(".infinite-scroll").eq(n-1),f=u.find(".nomore");return void(0===f.length&&u.find(".datalist").append("<div class='nomore' style='text-align:center;font-size: 0.8rem;'>---- 没有更多了 ----</div>"))}}}else if(e&&"403"===e.code){var h=location.href;h=encodeURIComponent(h),$.ajax({url:"/m/api/global/visited.json?url="+h,type:"get",dataType:"json",success:function(){window.location.href=c.config.loginHref}})}else $.toast("error:"+e.msg)}})},initShare:function(e,t,o){var n="";n=o?"http://"+location.host+"/shop/static/html/detail/detail.html?shopCode="+p.params.selectedShopCode+"&productCode="+p.params.selectedProCode:"http://"+location.host+"/shop/static/html/index/index.html?shopCode="+p.params.selectedShopCode;var i={imageUrl:t,url:n,desc:"",title:e,site:"酷鸟",appid:"",summary:"酷鸟",pics:t,appkey:"",ralateUid:"",pageUrl:this.params.selectDetailUrl},r=l.weibo(i.appkey,i.ralateUid,i.title,i.url,i.imageUrl);$(".weibo").find("a").attr("href",r);var s=l.qq_friends(i.site,i.title,i.imageUrl,i.appid,i.url,i.pageUrl);$(".QQFriends").find("a").attr("href",s);var a=l.qzone(i.url,i.title,i.desc,i.summary,i.site,i.pics);$(".Qzone").find("a").attr("href",a)}};$(document).on("pageInit","#page_myCollection",function(e,t,o){p.init(),$(function(){$(".menu_click_shade").css({display:"none"}),$(".click2").css({display:"none"}),$(".click1").css({display:"none"}),$(".menu_click_shade").css({display:"none"}),$(".myCollection_shade").css("display","none").css("bottom","-218px"),$(".myCollection_share").css("display","none").css("bottom","-218px")}),i=!1;var r=10;$(o).off("infinite").on("infinite",function(){if(!i){i=!0,n=$(".tabs .active").attr("id"),n=n.substring(3,n.length),n=parseInt(n);var e=$(".tabs .active .content-block").length;if(!p.params.maxItems[n]||e>=p.params.maxItems[n]){$(".infinite-scroll");$(".infinite-scroll-preloader").eq(n-1).hide();var t=$(".infinite-scroll").eq(n-1),o=t.find(".nomore");return 0===o.length&&t.find(".datalist").append("<div class='nomore' style='text-align:center;font-size: 0.8rem;'>---- 没有更多了 ----</div>"),void(i=!1)}1===n?(p.params.pageNum++,p.getProdFav(p.params.pageNum,r)):2===n&&(p.params.pageNum2++,p.getShopFav(p.params.pageNum2,r))}})})},{"../common/etpl.js":1,"../common/global.js":2,"../common/share.js":3,"./tpl/memberMyCollectionPro.html":5,"./tpl/memberMyCollectionShop.html":6}],5:[function(e,t,o){t.exports='<!-- for: ${prodInfoList} as ${prodInfo} -->  <div class="content-block">\t\t<input type="hidden" value="${prodInfo.productCode}" class="productCode" />\t\t<input type="hidden" value="${prodInfo.shopCode}" class="shopCode" />        <div class="product_list">      <div class="product_list_l">        <img src="${prodInfo.imgSrc}">        <!-- if: ${prodInfo.visit_status} == \'2\' -->        <div class="under_shelf">已下架</div>        <!-- /if -->      </div>      <div class="product_list_r">        <div class="product_list_r_title">${prodInfo.name}</div>        <div class="product_list_r_money">￥${prodInfo.price}</div>        <div class="product_list_r_menu" id="product_menu">          <div class="menu_circular left"></div>          <div class="menu_circular mid" ></div>          <div class="menu_circular right"></div>        </div>      </div>    </div>  </div><!-- /for -->      '},{}],6:[function(e,t,o){t.exports='  <!-- for: ${shopInfoList} as ${shopInfo} -->  <div class="content-block">  <input type="hidden" value="${shopInfo.shopCode}" class="shopCode" />    <div class="product_list">      <div class="product_list_l">        <!-- if: ${shopInfo.imgSrc} -->            <img src="${shopInfo.imgSrc}">        <!-- else -->            <img src="../../images/home/shop_default.jpg" onerror="this.src=\'../../images/home/shop_default.jpg\'" />        <!-- /if -->      </div>      <div class="product_list_r">        <div class="product_list_r_title">${shopInfo.name}</div>        <!-- <div class="product_list_r_star">          <span class="score"><em style="width:${shopInfo.score|scoreFormat}% ;"></em></span>          ${shopInfo.score}分        </div> -->        <div class="product_list_r_menu" id="shop_menu">          <div class="menu_circular left"></div>          <div class="menu_circular mid" ></div>          <div class="menu_circular right"></div>        </div>      </div>    </div>  </div>  <!-- /for -->'},{}]},{},[4]);