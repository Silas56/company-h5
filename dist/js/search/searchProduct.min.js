!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){!function(t){function r(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function i(){this.raw=[],this.length=0}function o(){return"___"+O++}function a(t,e){var n=new Function;n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function s(t){return P[t]}function c(t){return'"'+t.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function p(t){return t.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(t){return"\\"+t})}function l(t){var e=arguments;return t.replace(/\{([0-9]+)\}/g,function(t,n){return e[n-0+1]})}function u(t){return t=t.replace(/^\s*\*/,""),l('gv({0},["{1}"])',c(t),t.replace(/\[['"]?([^'"]+)['"]?\]/g,function(t,e){return"."+e}).split(".").join('","'))}function h(t,e,n,r,i,o){for(var a=n.length,s=t.split(e),c=0,p=[],l=0,u=s.length;u>l;l++){var h=s[l];if(l){var f=1;for(c++;;){var d=h.indexOf(n);if(0>d){p.push(c>1&&f?e:"",h);break}if(c=r?c-1:0,p.push(c>0&&f?e:"",h.slice(0,d),c>0?n:""),h=h.slice(d+a),f=0,0===c)break}0===c&&(i(p.join("")),o(h),p=[])}else h&&o(h)}c>0&&p.length>0&&(o(e),o(p.join("")))}function f(t,e,n){var r,i=[],o=e.options,a="",s="",p="",l="";return n&&(a="ts(",s=")",p=A,l=B,r=o.defaultFilter),h(t,o.variableOpen,o.variableClose,1,function(t){n&&t.indexOf("|")<0&&r&&(t+="|"+r);var o=t.indexOf("|"),c=(o>0?t.slice(0,o):t).replace(/^\s+/,"").replace(/\s+$/,""),h=o>0?t.slice(o+1):"",d=0===c.indexOf("*"),g=[d?"":a,u(c),d?"":s];if(h){h=f(h,e);for(var v=h.split("|"),y=0,m=v.length;m>y;y++){var $=v[y];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test($)&&(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&g.push(",",RegExp.$3),g.push(")"))}}i.push(p,g.join(""),l)},function(t){i.push(p,n?c(t):t,l)}),i.join("")}function d(t,e){this.value=t,this.engine=e}function g(t,e){this.value=t,this.engine=e,this.children=[],this.cloneProps=[]}function v(t,e){var n=t.stack,r=e?n.find(function(t){return t instanceof e}):n.bottom();if(r){for(var i;(i=n.top())!==r;){if(!i.autoClose)throw new Error(i.type+" must be closed manually: "+i.value);i.autoClose(t)}r.close(t)}return r}function y(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.master=RegExp.$3,this.name=RegExp.$1,g.call(this,t,e),this.blocks={}}function m(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,g.call(this,t,e),this.cloneProps=["name"]}function $(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,g.call(this,t,e),this.cloneProps=["name","state","blocks","target"],this.blocks={}}function x(t,e){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.expr=RegExp.$2,g.call(this,t,e),this.cloneProps=["name","expr"]}function b(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,t,e),this.cloneProps=["name","args"]}function w(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,g.call(this,t,e),this.cloneProps=["name","args"]}function R(t,e){var n=new RegExp(l("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",p(e.options.variableOpen),p(e.options.variableClose)),"i");if(!n.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,g.call(this,t,e),this.cloneProps=["list","item","index"]}function E(t,e){g.call(this,t,e)}function _(t,e){E.call(this,t,e)}function S(t,e){g.call(this,t,e)}function k(t,e){e.target=t;var n=e.engine,r=t.name;if(n.targets[r])switch(n.options.namingConflict){case"override":n.targets[r]=t,e.targets.push(r);case"ignore":break;default:throw new Error("[ETPL_TARGET_EXISTS]"+r)}else n.targets[r]=t,e.targets.push(r)}function C(t,e){N[t]=e,e.prototype.type=t}function D(t){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]*)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(t),this.targets={},this.filters=r({},j)}function I(t,e){function n(){var t;if(l.length>0&&(t=l.join(""))){var n=new d(t,e);n.beforeAdd(p),c.top().addChild(n),l=[],e.options.strip&&p.current instanceof g&&(n.value=t.replace(/^[\x20\t\r]*\n/,"")),p.current=n}}var r,o=e.options.commandOpen,a=e.options.commandClose,s=e.options.commandSyntax,c=new i,p={engine:e,targets:[],stack:c,target:null},l=[];return h(t,o,a,0,function(t){var i,c=s.exec(t);if(c&&(i=c[2]||"target")&&(r=N[i.toLowerCase()])&&"function"==typeof r){n();var u=p.current;e.options.strip&&u instanceof d&&(u.value=u.value.replace(/\r?\n[\x20\t]*$/,"\n")),c[1]?u=v(p,r):(u=new r(c[3],e),"function"==typeof u.beforeOpen&&u.beforeOpen(p),u.open(p)),p.current=u}else/^\s*\/\//.test(t)||l.push(o,t,a);r=null},function(t){l.push(t)}),n(),v(p),p.targets}i.prototype={push:function(t){this.raw[this.length++]=t},pop:function(){if(this.length>0){var t=this.raw[--this.length];return this.raw.length=this.length,t}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(t){for(var e=this.length;e--;){var n=this.raw[e];if(t(n))return n}}};var O=178245,P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},j={html:function(t){return t.replace(/[&<>"']/g,s)},url:encodeURIComponent,raw:function(t){return t}},T='var r="";',A="r+=",B=";",z="return r;";"undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(T="var r=[],ri=0;",A="r[ri++]=",z='return r.join("");'),d.prototype={getRendererBody:function(){var t=this.value,e=this.engine.options;return!t||e.strip&&/^\s*$/.test(t)?"":f(t,this.engine,1)},clone:function(){return this}},g.prototype={addChild:function(t){this.children.push(t)},open:function(t){var e=t.stack.top();e&&e.addChild(this),t.stack.push(this)},close:function(t){t.stack.top()===this&&t.stack.pop()},getRendererBody:function(){for(var t=[],e=this.children,n=0;n<e.length;n++)t.push(e[n].getRendererBody());return t.join("")},clone:function(){for(var t=this.constructor,e=new t(this.value,this.engine),n=0,r=this.children.length;r>n;n++)e.addChild(this.children[n].clone());for(var n=0,r=this.cloneProps.length;r>n;n++){var i=this.cloneProps[n];e[i]=this[i]}return e}};var L='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';a(y,g),a(m,g),a($,g),a(x,g),a(b,g),a(w,g),a(R,g),a(E,g),a(_,E),a(S,E);var V={READING:1,READED:2,APPLIED:3,READY:4};$.prototype.applyMaster=y.prototype.applyMaster=function(t){function e(t){var r=t.children;if(r instanceof Array)for(var i=0,o=r.length;o>i;i++){var a=r[i];a instanceof m&&n[a.name]&&(a=r[i]=n[a.name]),e(a)}}if(this.state>=V.APPLIED)return 1;var n=this.blocks,r=this.engine.targets[t];if(r){if(r.applyMaster(r.master))return this.children=r.clone().children,e(this),this.state=V.APPLIED,1}else if("error"===this.engine.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+t+", when extended by "+(this.target?this.target.name:this.name))},y.prototype.isReady=function(){function t(i){for(var o=0,a=i.children.length;a>o;o++){var s=i.children[o];if(s instanceof $){var c=e.targets[s.name];if(!c&&"error"===e.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+s.name+", when imported by "+n);r=r&&c&&c.isReady(e)}else s instanceof g&&t(s)}}if(this.state>=V.READY)return 1;var e=this.engine,n=this.name,r=1;return this.applyMaster(this.master)?(t(this),r&&(this.state=V.READY),r):void 0},y.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var t=new Function("data","engine",[L,T,this.getRendererBody(),z].join("\n")),e=this.engine;return this.renderer=function(n){return t(n,e)},this.renderer}return null},y.prototype.open=function(t){v(t),g.prototype.open.call(this,t),this.state=V.READING,k(this,t)},x.prototype.open=w.prototype.open=function(t){t.stack.top().addChild(this)},m.prototype.open=function(t){g.prototype.open.call(this,t),t.stack.find(function(t){return t.blocks}).blocks[this.name]=this},_.prototype.open=function(t){var e=new S;e.open(t);var n=v(t,E);n.addChild(this),t.stack.push(this)},S.prototype.open=function(t){var e=v(t,E);e.addChild(this),t.stack.push(this)},$.prototype.open=function(t){this.parent=t.stack.top(),this.target=t.target,g.prototype.open.call(this,t),this.state=V.READING},w.prototype.close=x.prototype.close=function(){},$.prototype.close=function(t){g.prototype.close.call(this,t),this.state=V.READED},y.prototype.close=function(t){g.prototype.close.call(this,t),this.state=this.master?V.READED:V.APPLIED,t.target=null},$.prototype.autoClose=function(t){var e=this.parent.children;e.push.apply(e,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(t)},w.prototype.beforeOpen=$.prototype.beforeOpen=x.prototype.beforeOpen=R.prototype.beforeOpen=b.prototype.beforeOpen=m.prototype.beforeOpen=E.prototype.beforeOpen=d.prototype.beforeAdd=function(t){if(!t.stack.bottom()){var e=new y(o(),t.engine);e.open(t)}},$.prototype.getRendererBody=function(){return this.applyMaster(this.name),g.prototype.getRendererBody.call(this)},w.prototype.getRendererBody=function(){return l("{0}engine.render({2},{{3}}){1}",A,B,c(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(t,e,n){return(e||"")+c(n)+":"}))},x.prototype.getRendererBody=function(){return this.expr?l("v[{0}]={1};",c(this.name),f(this.expr,this.engine)):""},E.prototype.getRendererBody=function(){return l("if({0}){{1}}",f(this.value,this.engine),g.prototype.getRendererBody.call(this))},S.prototype.getRendererBody=function(){return l("}else{{0}",g.prototype.getRendererBody.call(this))},R.prototype.getRendererBody=function(){return l('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',o(),f(this.list,this.engine),c(this.index||o()),c(this.item),o(),o(),g.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var t=this.args;return l("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",T,z,A,B,g.prototype.getRendererBody.call(this),c(this.name),t?","+f(t,this.engine):"")};var N={};C("target",y),C("block",m),C("import",$),C("use",w),C("var",x),C("for",R),C("if",E),C("elif",_),C("else",S),C("filter",b),D.prototype.config=function(t){r(this.options,t)},D.prototype.compile=D.prototype.parse=function(t){if(t){var e=I(t,this);if(e.length)return this.targets[e[0]].getRenderer()}return new Function('return ""')},D.prototype.getRenderer=function(t){var e=this.targets[t];return e?e.getRenderer():void 0},D.prototype.render=function(t,e){var n=this.getRenderer(t);return n?n(e):""},D.prototype.addFilter=function(t,e){"function"==typeof e&&(this.filters[t]=e)};var q=new D;q.Engine=D,q.version="3.1.0","object"==typeof n&&"object"==typeof e?n=e.exports=q:"function"==typeof define&&define.amd?define(q):t.etpl=q}(this)},{}],2:[function(t,e,n){var r=function(){};r.prototype.getUrlParam=function(){for(var t=location.search.slice(1),e={},n=t.split("&"),r=0;r<n.length;r++){var i=n[r].split("=");e[i[0]]||(e[i[0]]=i[1])}return e},r.prototype.localStorage={get:function(t){var e="";if("undefined"==typeof localStorage[t])return!1;try{return e=JSON.parse(localStorage[t]),"undefined"!=typeof e.value?e.value:e}catch(n){return localStorage[t]}},set:function(t,e){return"undefined"!=typeof e&&(localStorage[t]=JSON.stringify({value:e}),!0)},del:function(t){"undefined"==typeof localStorage[t]?console.log("this item is not exit!"):delete localStorage[t]}},r.prototype.sessionStorage={get:function(t){var e="";if("undefined"==typeof sessionStorage[t])return"undefined";try{return e=JSON.parse(sessionStorage[t]),"undefined"!=typeof e.value?e.value:e}catch(n){return sessionStorage[t]}},set:function(t,e){return"undefined"!=typeof e&&(sessionStorage[t]=JSON.stringify({value:e}),!0)},del:function(t){"undefined"==typeof sessionStorage[t]?console.log("this item is not exit!"):delete sessionStorage[t]}},r.prototype.config={serverBase:"/m/",knIndex:"/m/nav/kn/index",loginHref:"/m/nav/login",logoutHref:"/m/nav/logout"},"object"==typeof e&&"object"==typeof e.exports?e.exports=new r:window.GlobalKuNiao=r},{}],3:[function(t,e,n){var r=t("../common/global.js"),i=t("../common/etpl.js"),o=t("./tpl/product.html"),a={param:{maxItems:[],loading:!1},init:function(){var t=r.getUrlParam();t.catevalue||(t.catevalue="");var e=decodeURIComponent(t.catevalue);"*"===e&&(e=""),$("input[name=cateValue]").val(e),this.initData(),this.initButtons()},initData:function(){$(".datalist").html("");var t=$("input[name=cateValue]").val();t&&0!==t.trim().length||(t="*"),this.getData($("#tab1 .datalist"),t,0,10),this.getData($("#tab2 .datalist"),t,0,10,"sales","desc"),this.setPriceSortType(),this.getData($("#tab3 .datalist"),t,0,10,"price","desc")},initButtons:function(){$(document).on("click",".tab-link",function(){var t=$(this),e=t.data("tab")||t.attr("href"),n=$(e);n.siblings().removeClass("active"),n.addClass("active");var r=e.substr(e.indexOf("#tab")+4,e.length-1);if("3"===r&&t.hasClass("active")){a.setPriceSortType();var i=n.attr("pi"),o=$(".price").attr("sortType");o="1"===o?"desc":"asc";var s=$("input[name=cateValue]").val(),c=!0;a.getData(n.find(".datalist"),s,i,10,"price",o,c)}else if(0===n.find(".datalist").children().length){var p="1"===r?"*":"2"===r?"sales":"price",l=$("input[name=cateValue]").val();a.getData(n.find(".datalist"),l,0,10,p,"desc")}t.parent().children(".active").removeClass("active"),t.addClass("active")}),$(".btnsearch").click(function(){var t=$("input[name=cateValue]").val();0===t.trim().length&&(t="*"),a.search(t)}),$(".category").change(function(){$(".cateValue").val("");var t=$(this).val();"0"===t?$(".cateValue").attr("placeholder","请输入产品名称"):$(".cateValue").attr("placeholder","请输入店铺名称")}),$(".clearCateValue").click(function(){$(".cateValue").val(""),window.location.href="search.html"})},getData:function(t,e,n,s,c,p,l){var u={keyWord:e,from:n,size:s};c&&""!==c.trim()&&(u.sortField=c,u.sortType=p);var h=e+"，酷鸟旅游网，一个提供特色旅游(旅行)、高端旅游(旅行)、主题旅游(旅行)、旅游线路、旅行线路的旅游网站，特色旅游找酷鸟。";this.setSEO(h),$.ajax({url:r.config.serverBase+"/api/search/productSearch.json",type:"GET",data:u,success:function(e){if(e&&"100"==e.code){var r=t.parent().attr("id"),s=e.resultList;if(s&&s.length>0){r=r.substring(3,r.length),a.param.maxItems[r]=e.count;for(var c=i.compile(o),p=0;p<s.length;p++)if(s[p].scores_>0){for(var u=parseInt(s[p].scores_),h=1*s[p].scores_-u,f=[],d=0;d<5;d++)d<u?f[d]="18px":d==u?f[d]=18*h+"px":f[d]="0px";s[p].scoreList=f}var g={products:s},v=c(g);if(l?t.html(v):t.append(v),a.loading=!1,$.refreshScroller(),$(".chanpin").unbind("click").click(function(){var t=$(this).find(".shopCode").val(),e=$(this).find(".productCode").val();window.location.href="../detail/detail.html?productCode="+e+"&shopCode="+t}),n+10>e.count){$(".infinite-scroll-preloader").eq(r-1).hide();var y=$(".infinite-scroll").eq(r-1),m=y.find(".nomore");return void(0===m.length&&y.find(".datalist").append("<div class='nomore'>---- 没有更多了 ----</div>"))}}else{var x=$(".tabs .active");x.html('<div class="datalist"></div>'),x.append('<div class="tip">非常抱歉，没有找到相关结果</div>'),a.getRecommand()}}}})},getRecommand:function(){$.ajax({url:r.config.serverBase+"/api/search/productRecommand.json",type:"GET",success:function(t){if(t&&"100"==t.code){var e=t.resultList;if(e&&e.length>0){var n=i.compile(o),r={products:e},a=n(r),s=$(".tabs .active");s.append("<div>"),s.append('<hr class="line"/>'),s.append('<div class="recommandtip">推荐产品</div>'),s.append('<hr class="line"/>'),s.append("</div>"),s.append(a)}}else $.toast("error:"+t.msg)}})},setPriceSortType:function(){var t=$(".price"),e=t.attr("sortType"),n="";"1"===e?(n=".downarrow",e="0"):(n=".uparrow",e="1"),$(n).css("display","block");var r=$(n).siblings();r.css("display","none"),t.attr("sortType",e)},search:function(t,e){var n=e?e:$("select[name=category]").val(),i="0"===n?"searchProduct.html":"searchShop.html";if(t=encodeURIComponent(t),t&&t.trim().length>0&&"*"!==t.trim()){var o=r.localStorage.get("his"),a=[],s={};if(s.type=n,s.text=t,o&&"undefined"!==o){var c=!1;$.each(o,function(e,r){if(r&&r.type===n&&r.text===t)return c=!0,!1}),c||o.push(s)}else a.push(s),o=a;r.localStorage.set("his",o)}window.location.href=i+"?catevalue="+t},setSEO:function(t){$('meta[name="Description"]').attr("content",t)}};$(document).on("pageInit","#searchProduct_page",function(t,e,n){a.init(),a.loading=!1;var r=10;$(n).on("infinite",function(){if(!a.loading){a.loading=!0;var t=$(".tabs .active").attr("id");t=t.substring(3,t.length),t=parseInt(t);var e=$(".tabs .active .chanpin").length;if(e=0===e?0:e,!a.param.maxItems[t]||e>=a.param.maxItems[t]){$(".infinite-scroll-preloader").eq(t-1).hide();var n=$(".infinite-scroll").eq(t-1),i=n.find(".nomore");return 0===i.length&&n.find(".datalist").append("<div class='nomore'>---- 没有更多了 ----</div>"),void(a.loading=!1)}var o=$("input[name=cateValue]").val();if(0===o.trim().length&&(o="*"),3===t){var s=$(".price").attr("sortType");s="1"===s?"desc":"asc",a.getData($("#tab"+t+" .datalist"),o,e,r,"price",s)}else a.getData($("#tab"+t+" .datalist"),o,e,r)}})})},{"../common/etpl.js":1,"../common/global.js":2,"./tpl/product.html":4}],4:[function(t,e,n){e.exports='<!-- for: ${products} as ${product} --><div class="chanpin">\t<input type="hidden" class="shopCode" value="${product.shop_code_}" />\t<input type="hidden" class="productCode" value="${product.code_}" />    <div class="chanpin_list_l">        <!-- if: ${product.symbol_image_} -->            <img src="${product.symbol_image_}">        <!-- else -->            <img src="../../images/home/shop_default.jpg" />        <!-- /if -->    </div>    <div class="chanpin_list_r">        <div class="chanpin_name">${product.name_}</div>        <div class="chanpin_p_s">            <div class="chanpin_price">￥${product.price_}</div>             <!-- if: ${product.scores_} -->            <div class="chanpin_star">                               <ul>                    <!-- for: ${product.scoreList} as ${scoreItem} -->                    <li><span style="width:${scoreItem};"></span></li>                    <!-- /for -->                </ul>                <span class="score">${product.scores_}分</span>            </div>              <!-- /if -->        </div>    </div></div><!-- /for -->'},{}]},{},[3]);